$6e.prototype.Osa=X(1535,function(){return[]});$6e.prototype.Dsa=X(1534,ea("Answers feedback"));kW.prototype.VL=X(1533,ea(10));GW.prototype.VL=X(1532,g("Sa"));IW.prototype.VL=X(1531,g("D"));Hbf.prototype.VL=X(1530,ea(10));N0e.prototype.gea=X(1526,ea(null));$6e.prototype.gea=X(1525,g("F"));var EVf={1:ika,2:Xf},FVf={2:{1:[{1:[EVf],2:EVf}]}};function GVf(a,b){return L(a,1,b)}function HVf(a,b){D(a,1,b)}function IVf(a){var b=Oa();L(a,3,b)}
function JVf(a,b,c){var d=Xj(a.C,kT,1),e=new kT;L(e,1,b);L(e,2,c);L(e,4,0);IVf(e);d.push(e);zd(d,function(f,h){return(h.hj()||0)-(f.hj()||0)});wd(d,void 0,function(f){return K(f,1)+", "+f.gb()});bk(a.C,1,vd(d,0,a.O));Dne(a)}function KVf(a){return a.D["ritz-ShouldDisplaySmartFillSurvey"]}function LVf(a,b){a.C.Ja=b}function MVf(a,b){a=a.C;a.Sa=b;null==a.Ea||a.Sa.includes(a.Ea)||QO(a)}function NVf(a){bo.call(this,a)}r(NVf,bo);NVf.prototype.hasType=function(){return this.message.hasType()};
NVf.prototype.getType=function(){return this.message.getType()};NVf.prototype.setType=function(a){return ho(this,1,a)};NVf.prototype.clearType=function(){return eo(this,1)};function OVf(a){this.Eb=Nn(a,-1,0)}r(OVf,Rn);OVf.prototype.fc=function(){return new NVf(this)};OVf.prototype.hasType=function(){return Vn(this,1)};OVf.prototype.getType=function(){return Zn(this,1,0)};function PVf(a){bo.call(this,a)}r(PVf,bo);PVf.prototype.getRange=function(){return this.message.getRange()};
function QVf(a){this.Eb=Nn(a,-1,0)}r(QVf,Rn);QVf.prototype.fc=function(){return new PVf(this)};QVf.prototype.getRange=function(){return this.qg(1,lo)};function RVf(a,b,c){pJ.call(this,156);this.mb=a;this.F=b;this.C=c}r(RVf,pJ);RVf.prototype.Ld=function(){var a=new VQb;this.C.forEach(function(b){var c=C(b,1),d=new Rr;b=b.getValue();D(d,3,b);b=new Sr;var e=c.$i();D(b,1,e);c=c.getColumnIndex();D(b,2,c);D(b,3,d);Zg(a,2,b)});HVf(a,qo(this.F,this.mb.Kb()));return uJ(a,Tn(QVf))};RVf.prototype.Fg=ea(!1);
function SVf(a,b){var c=a.D.sb(b);return new Sp(function(d,e){Sl(Tl(ar(Rl(ir(jr(a.C.$e("/smartFill/getSuggestion"),"POST")),1).setTimeout(3E4),["data",Sm(c)]),function(f){f=a.D.Qd(oS.getDescriptor(),f.Pe());1!=f.getStatus()&&e(f);d(f)}),function(){var f=new oS;D(f,1,2);e(f)}).Se()})}function TVf(a){A.call(this);this.D=a;this.C=KVf(this.D.F).getValue()}r(TVf,A);
function UVf(a){a.C&&KVf(a.D.F).getValue()?(lA.getInstance().postMessage(oA("Please take a quick 3-question survey about SmartFill","Take survey",function(){cf("https://google.qualtrics.com/jfe/form/SV_5pEvy5W5UY82FjT")},"promo",!0,void 0,void 0)),a.C=!1,KVf(a.D.F).setValue(!1)):a.C=!1}function VVf(a){a.C&&aq(function(){return UVf(a)},6E4)}function WVf(a,b,c,d,e){this.D=a;this.L=b;this.C=c;this.O=d;this.F=e;this.H=!1;this.J=0}WVf.prototype.gj=g("L");WVf.prototype.Hd=g("O");
WVf.prototype.equals=function(a){if(!a||this.D!=a.D)return!1;if(null!=this.Hd()){if(!a.Hd()||this.Hd().length!=a.Hd().length)return!1;for(var b=0;b<this.Hd().length;b++)if(!this.Hd()[b].equals(a.Hd()[b]))return!1;return!0}return this.gj()==a.gj()};function XVf(a){var b=pS.getInstance(),c=a.rect;if(!c)return null;b=b.C[a.C];if(!b)return null;var d=b[c.left+c.width-1];if(!d)return null;d=d.C;return!d||a.rect.top<d.$i()?null:b[c.left+c.width-1]||null}
function YVf(a,b,c){var d=pS.getInstance();c=void 0===c?!1:c;var e=a.rect;if(e){a=a.C;var f=d.C[a];if(f){e=e.left+e.width-1;var h=f[e]||null;ee(f,e);b&&h&&(c&&(h.H=!0),b=d.D[a],b||(b={},d.D[a]=b),d=b[e],d||(d=[],b[e]=d),d.push(h))}}}function ZVf(a,b){var c=b.rect;return c?(a=a.D[b.C])?a[c.left+c.width-1]||[]:[]:[]}function $Vf(a,b){var c=pS.getInstance();return!!id(ZVf(c,a),function(d){return b.equals(d)})}function aWf(a){return z(y(),"femfs")&&Fpc(a.F.F)}
function bWf(a){var b=a.F.C,c=b.C;return Tpc(a.F)?XH(b,a.F.Qa):c}function cWf(a,b){return 0>b.x||0>b.y?null:tI(pI(a,b),a.Kb(),b.y,b.x)}function dWf(a){return(a=vJ(a.C))?a.H:null}function eWf(a){return a.D.isEnabled()||GI(a.D)}
function fWf(a,b,c,d,e){if(c.gj()){var f=c.gj();c=Jl(a.J.sb(c.C),ika);return a.ma.getCalculatedSmartFillSuggestion(QWe(d).sb(),f.startsWith("=")?f:"="+f,c,b.Sc()+50,e)}return ritz_api.GridViewApi.getSmartFillSuggestionForValues(c.Hd().map(function(h){return Jl(a.J.sb(h),EVf)}))}function gWf(a,b,c,d){var e=bz(new az,22);c&&(c=1E3*((new Date).getTime()-c),c=zk(new yk,c),dz(bz(e,41),c));c=new Dk;d=Yj(c,31,d);ez(e,d);a.Ea.C(b,fz(e))}
function c_(a,b,c,d,e,f,h){var k=new R9d;d&&L(k,1,d);e&&Yj(k,2,e);f&&Yj(k,4,f);h&&L(k,3,h);gWf(a,b,c,k)}function hWf(a,b,c){switch(b){case 3:return c_(a,36754,c),!0;case 4:return c_(a,36755,c),z(y(),"fesfs");case 2:return c_(a,36757,c),!1;case 5:return c_(a,36835,c),!1;default:return c_(a,36756,c),!1}}
function iWf(a){Eo(a.O,a.F.Hb,function(b){if("smartfill-show-nudge"==b.getType()){var c=bWf(a),d=c.Fc(),e=d.F;b=new Mn(c.gb(),e);var f=XVf(b);if(f&&f.gj()&&(d=cWf(d,new Vm(QI(d).x,QI(d).y)))&&LE(d)){var h=f.C;if(ritz_api.RitzModelApi.areFormulasTheSameForSmartfill(d,c.gb(),e.Sc(),e.Wc(),f.gj(),h.gb(),h.$i(),h.getColumnIndex())){if(c=vJ(a.C))KPc(c,"Next time, try entering sample expected values instead."),c_(a,36830,void 0,f.D,void 0,f.F);YVf(b,!1)}}}})}
function jWf(a,b){b=b.C;var c=un(b.$i(),b.getColumnIndex());a=Eme(a,c,["W","N","S"],1E3);return new rn(b.$i(),a.Wc()-1,a.Sc(),a.Wc())}function kWf(a){return(a=dWf(a))?a.Sa:null}function lWf(a,b){b=void 0===b?!1:b;var c=vJ(a.C);if(c){ritz_api.GridViewApi.removeSmartFillSuggestion(c.L.J);var d=kWf(a);d&&d.Oe();b&&c.Qc();a.H=null}}function mWf(a){return"SmartFill suggestion shown. Preview added to cells in range {"+(a+"}")}function nWf(a){var b=new N9d,c=C(a,1);L(b,1,c);a=C(a,2);L(b,2,a);return b}
function oWf(a,b){if(aWf(a)){var c=(new Date).getTime();SVf(a.IDa,b).then(function(d){var e=C(d,4);c_(a,36766,c,e);var f=C(d,2),h=ah(d,5);d=h&&0<h.length?new WVf(e,null,C(d,7),h,nWf(C(d,8))):d.gj()?new WVf(e,d.gj(),C(d,7),null,nWf(C(d,8))):null;h=ro(f);if(d&&!$Vf(h,d)&&(f=pS.getInstance(),e=h.rect)){h=h.C;var k=f.C[h];k||(k={},f.C[h]=k);k[e.left+e.width-1]=d}},function(d){var e=void 0;d instanceof oS&&Xg(d,6)&&(e=C(d,6));c_(a,36767,c,void 0,void 0,void 0,e)})}}
function pWf(a,b,c,d,e,f,h,k,l,n){A.call(this);this.F=a;this.C=b;this.V=c;this.Ea=d;this.Za=e;this.IDa=rEd.getInstance();this.J=new Hl;this.ma=h;this.va=k;this.Ba=n;(this.D=z(y(),"fess")?new TVf(this.F):null)&&this.qa(this.D);this.H=null;this.L=new Vo(this);this.qa(this.L);this.R=new Uz(this);this.qa(this.R);this.O=new Do;this.qa(this.O);a=nG(this.V);this.L.listen(this.C,"inputBoxDeactivate",this.T6b).listen(this.C,"inputBoxActivate",this.S6b).listen(this.C,"valueChange",this.uSb).listen(a,["qc",
"rc","sc","tc"],this.U6b).listen(a,["Ub","Vb","Wb"],this.tDb);iWf(this);aWf(this)&&(JCb.Pa(!0),JCb.setVisible(!0),l.C(ICb,tEd).D(ICb,tEd).C(KCb,tEd).D(KCb,tEd));aWf(this)&&this.R.subscribe(ICb,"action",this.Aqb).subscribe(KCb,"action",this.sSa).subscribe(JCb,"action",this.V6b)}r(pWf,A);m=pWf.prototype;
m.T6b=function(a){if(a.ma){if(!aWf(this))return;var b=(new Date).getTime(),c=bWf(this);a=vJ(this.C);if(c&&a){var d=dWf(this);if(d&&!d.H.L){var e=c.Fc();if(!eWf(e)){var f=e&&FH(e,WN(d).Zr);if(f&&0!=f.x){var h=new Mn(c.gb(),tn(f)),k=XVf(h);k&&3<=k.J&&YVf(h,!0,!0);if((d=WN(d))&&d.getValue()&&0!=d.getValue().trim().length&&d.Rc!=d.getValue()&&(d=d.getValue(),!LE(d)||z(y(),"fesfs")&&ritz_api.RitzModelApi.hasValidSmartfillFunctions(d,c.gb(),f.y,f.x)))if(k)a=ritz_api.GridViewApi.getSmartFillSuggestionValueAt(a.L.J,
c.gb(),f.y,f.x),""!=d&&a&&d!=a&&!LE(d)&&this.sSa();else{k=pS.getInstance();if(h=!(3<=ZVf(k,h).length))a:{for(h=1;10>=h;h++)if(cWf(e,new Vm(f.x,f.y+h))){h=!1;break a}h=!0}if(h)if(h=ritz_api.RitzModelApi.getSmartFillRequestTriggerResult(c.gb(),f.y,f.x,z(y(),"fesfs")),h=Il(h,FVf),h=this.J.Qd(pEd.getDescriptor(),h),k=C(h,1),hWf(this,k,b))oWf(this,C(h,2));else if(2===k){b=c.gb();e=Eme(e,un(f.y,f.x),["N"],80);f=new Mn(b,e);c=pS.getInstance();h=ZVf(c,f);c=[];for(k=0;k<h.length;k++){d=h[k];var l=d.C;l=new Mn(f.C,
un(l.$i(),l.getColumnIndex()));f.contains(l)&&d.H&&c.push(d)}for(h=0;h<c.length;h++)if(k=c[h],k.H=!1,d=fWf(this,a,k,f,!1),null!=d){l=Math.max(e.top,k.C.$i()+1);var n=e.top+e.height,q=ritz_api.RitzModelApi.numCellsMatchingSmartFillSuggestion(d,b,e.left,l,n);d=new P9d;l=L(d,1,n-l);L(l,2,q);l=new R9d;L(l,1,k.D);Yj(l,4,k.F);d&&Yj(l,5,d);gWf(this,36832,void 0,l)}}}}}}}}lWf(this,!0)};
m.S6b=function(){if(aWf(this)){var a=bWf(this),b=vJ(this.C);if(a&&b){var c=dWf(this);if(c&&!c.H.L&&WN(c)){var d=a.Fc();if(!eWf(d)){var e=d&&FH(d,WN(c).Zr);if(e){var f=new Mn(a.gb(),tn(e));if((e=XVf(f))&&e.C)if(d=jWf(d,e),a=new Mn(a.gb(),d),f.intersects(a)){f=(new Date).getTime();var h=fWf(this,b,e,a,!0);if(h&&(20>ritz_api.GridViewApi.getSmartFillAvgCharCountForSuggestion(h)||1<K(e.F,2))){var k=kWf(this);k&&(k.H=!0,k.D=c.O,k.D.V?k.F=null:k.F=k.D==c.C?c.L:null,eOc(k,!0));ritz_api.GridViewApi.updateSmartFillModel(b.L.J,
h);b.Qc();e.J+=1;c=new L9d;h=GVf(c,d.Sc()-d.kc());b=ritz_api.GridViewApi.getSmartFillSuggestionAvgCharCount(b.L.J);L(h,2,b);c_(this,36773,f,e.D,c,e.F);oJ(mWf(cM(d)));this.H=a}else lWf(this),YVf(a,!0)}else lWf(this,!0);else lWf(this,!0)}}}}}};
m.uSb=function(){if(aWf(this)&&this.H){var a=bWf(this),b=vJ(this.C);if(a&&b){var c=dWf(this);c&&!c.H.L&&WN(c)&&(b=a.Fc(),!eWf(b)&&(c=b&&FH(b,WN(c).Zr)))&&(c=new Mn(a.gb(),tn(c)),(c=XVf(c))&&c.C&&(b=jWf(b,c),(new Mn(a.gb(),b)).intersects(this.H)&&(oJ(mWf(cM(b))),this.H=null)))}}};
m.Aqb=function(){var a=this;if(aWf(this)){var b=bWf(this),c=b.Fc();if(!eWf(c)){var d=c.F,e=new Mn(b.gb(),d),f=XVf(e);if(f){var h=jWf(c,f),k=void 0;if(b=vJ(this.C))k=ritz_api.GridViewApi.getSmartFillSuggestionAvgCharCount(b.L.J),$N(b,!1);var l,n=f.Hd();n?l=new RVf(c,h,f.Hd()):l=new mud(c,h,f.gj());qJ(l,function(q){if(q){lWf(a,!0);YVf(e,!1);q=new L9d;GVf(q,h.Sc()-h.kc());k&&L(q,2,k);c_(a,36777,void 0,f.D,q,f.F);q=5===f.D;q=n?q?"Cells filled using Domain Directory.":"Cells filled with public data.":
"Cells filled with a formula.";var t=vJ(a.C);t&&IPc(t,q,"Send feedback",function(){(Mt(),Bv).qb({source:"smartfill"})});oJ(q);a.D&&VVf(a.D)}});this.va.C(l)}}}};
m.sSa=function(){if(aWf(this)){var a=bWf(this),b=a.Fc();if(!eWf(b)){var c=b.F;a=new Mn(a.gb(),c);var d=XVf(a);if(d){b=Eme(b,c,["N","S","W"]);c=new L9d;GVf(c,b.Sc()-b.kc());var e=vJ(this.C);e&&(e=ritz_api.GridViewApi.getSmartFillSuggestionAvgCharCount(e.L.J),L(c,2,e));c_(this,36778,void 0,d.D,c,d.F);lWf(this,!0);YVf(a,!0,!0);oJ("SmartFill suggestion rejected for range ("+(cM(b)+")."));this.D&&VVf(this.D)}}}};
m.V6b=function(){var a=bWf(this),b=a.Fc().F;a=new Mn(a.gb(),b);XVf(a)&&(a=kWf(this))&&a.H&&(a.La().focus(),this.Ba.Db(2))};m.U6b=function(){var a=bWf(this);a&&(a=a.Fc(),eWf(a)&&lWf(this))};m.tDb=function(){pS.getInstance().clear();lWf(this)};function qWf(a,b){var c=Vn(a,1)?no(a):Number.MIN_VALUE;a=Vn(a,2)?Yn(a,2):Number.MAX_VALUE;var d=Vn(b,1)?no(b):Number.MIN_VALUE;b=Vn(b,2)?Yn(b,2):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}function rWf(a){return co(fDa(dDa(),a))}
function sWf(a,b,c){var d=a.Sc(),e=a.Wc();switch(b){case 0:d=Math.min(d,a.kc()+c);break;case 1:e=Math.min(e,a.Qb()+c)}return HRb(a.gb(),a.kc(),a.Qb(),d,e)}
function tWf(){return T('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function uWf(a,b){return T(R(bA({hd:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:hx(""+R(CB({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(bA({hd:"waffle-assistant-zoom-button",content:hx(""+R(CB({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}
function vWf(a,b,c,d,e,f,h){ZW.call(this,a,b,c,KR.getInstance(),"regular",e,f,h);this.Ra=d;this.R=new jz(null,new YQ,this.oa());this.Ga(this.R);a=a.C;c=new YN(c,!0,!0);this.V=new Jbf(a,new g8e(c),b);this.V.Ba=this.F;b=co(ko($cc(Xcc(),!0),12,Hrb));this.Va=new Hcf(b);this.D=this.va=null;this.ma=[]}r(vWf,ZW);m=vWf.prototype;m.Jc=function(a){ZW.prototype.Jc.call(this,a);this.R.Wa(this.oa().cb("waffle-answers-button"))};
m.Ia=function(){ZW.prototype.Ia.call(this);this.getHandler().listen(this.Ra,"selectionChange",this.CYb)};m.NXa=function(a){this.V.L=a;this.O.cF(a)};m.cZ=function(){ZW.prototype.cZ.call(this);this.getHandler().listen(this.R,"action",this.Brb);wWf(this)};m.IG=function(){var a=this.J;return gI(a.C)?R_e(a)?ZW.prototype.IG.call(this):!1:!1};m.Pa=function(a){ZW.prototype.Pa.call(this,a);hW(this.R.getElement(),a?"":this.zda());this.R.Pa(a)};
m.DMa=function(){if(this.D){var a=mo(ritz_api.TablesApi.getTableGridRange(this.D));a=gG(a);return T5e(a,cI(this.J.C))}return null};m.rDa=function(){if(this.D){var a=mo(ritz_api.TablesApi.getTableGridRange(this.D));if(50>hG(a).height)return!1}a=fp("docs-titlebar-buttons");a=a.offsetWidth+Rw(a).right;return(Kw(this.H.getElement())?a:a+200)+700<=window.innerWidth};m.zda=ea("Answers is unavailable, try using Explore");
m.uP=function(){ZW.prototype.uP.call(this);var a=Ecf(this),b=this.rDa();this.R.setVisible(!b&&a)};m.Brb=function(){Q4e(null,this.ma,null,this.F)};m.tTa=function(a){Q4e(a,this.ma,null,this.F)};m.CYb=function(){xWf(this)&&wWf(this)};m.Mva=function(){var a=ZW.prototype.Mva.call(this);a&&(this.D=null,xWf(this)&&wWf(this));return a};function xWf(a){a=a.J;return gI(a.C)&&mM(a)}
function wWf(a){if(a.IG()){var b=a.J.C,c=jI(b),d=Ppd(c);if(0<d.length)b=mo(ritz_api.TablesApi.getTableGridRange(d[0])),a.D&&b.equals(mo(ritz_api.TablesApi.getTableGridRange(a.D)))||(a.D=d[0],a.o$());else if(null!=a.D){d=mo(ritz_api.TablesApi.getTableGridRange(a.D));b=d.gb()!=cI(b);var e=!1;if(!b){var f=YI(c);c=ritz_api.TablesApi.getCurrentlyDetectedTables(fG(f,c.Kb()).sb());c=ia(c);for(f=c.next();!f.done;f=c.next())if(f=mo(ritz_api.TablesApi.getTableGridRange(f.value)),f==d||null!=f&&f.equals(d)){e=
!0;break}}if(b||!e)a.D=null,a.L.C(36726,Fcf(a)),a.o$()}}else a.uC()}m.o$=function(){var a=this;this.uC();if(this.D){var b=mo(ritz_api.TablesApi.getTableGridRange(this.D)),c=[gG(b)];null!=this.va&&this.va.cancel();5E4<D4e(b)?this.L.C(36727,Fcf(this)):(this.va=Icf(this.Va,c),this.va.then(function(d){a.tb()&&yWf(a,d.C)}).oh(function(){a.uC()}))}};
function yWf(a,b){a.ma=b;var c=null;b=ia(b);for(var d=b.next();!d.done;d=b.next())d=d.value,3==bh(d,1)&&(c=d);if(c&&.6<C(c,2)){a.L.C(36728,Fcf(a));b=C(c,9)||new cJ;var e=cd(ah(b,1),function(l){return l.getName()}),f=[],h=[];d=ia(ah(b,2));for(var k=d.next();!k.done;k=d.next())k=k.value,f.push(k.getName()),h=h.concat(ah(k,2));d=ro(yV(c));k=Xg(c,11)?C(c,11):null;c=null==k?null:ro(C(c,10));a.V.init(b,d,c,k,[],[]);a.V.j_();a.V.k_().then(function(l){var n=h;l=void 0===l?[]:l;(e.length||f.length||n.length||
l.length)&&a.Pa(!0);a.O.s0(e,f,n);0<l.length&&(a.O.dP(l),z(y(),"feaipu")&&a.C&&a.C.D.setAttribute("placeholder",saf(l[0].query)));a.C&&zaf(a.C)})}R4e(a.ma,null,a.F)}m.uC=function(){ZW.prototype.uC.call(this);this.ma=[];this.V.reset();R4e(null,null,this.F)};function zWf(a,b){cS.call(this,void 0,b,!1,!0);this.H=a;this.setTitle("Additional info");this.C.setVisible(!1)}r(zWf,cS);
zWf.prototype.Ca=function(){var a=this;cS.prototype.Ca.call(this);Dx(this.La(),"waffle-assistant-feedback-product-info-dialog");var b=Object.keys(this.H).map(function(c){var d=a.H[c];return Qe("DIV",void 0,[Qe("DT",void 0,c+":"),Qe("DD",void 0,String(d))])});Tx(this,Re(b))};function AWf(a){var b=a.bU,c=a.index,d=a.checked;return T(R(GR({hd:"waffle-assistant-feedback-dialog-radio-button",name:hx(""+R(a.name)),label:b,checked:d,value:c+1},void 0)))}
function BWf(){var a='<div class="'+U("waffle-assistant-feedback-dialog-legal")+'"><small><div class="'+U("waffle-assistant-feedback-dialog-legal-information-text")+'">';a=a+'We will use the information that you give us to help address technical issues and to improve our services, subject to our <a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" class="uf-legal-link">Privacy Policy </a> and <a href="https://www.google.com/intl/en/policies/terms/" target="_blank" class="uf-legal-link">Terms of Service</a>.</div><div class="'+
(U("waffle-assistant-feedback-dialog-product-info-display-text")+'"><span tabindex="0" role="link">');return T(a+"What will be shared with Google?</span></div></small></div>")}function CWf(a,b){cS.call(this,void 0,b,!0,!0);this.R=a;this.L=a.Qza();this.ma=a.Osa();this.H=this.V=this.O=null;this.setTitle(a.Dsa());this.C.setContent("Submit")}r(CWf,cS);m=CWf.prototype;
m.Ca=function(){cS.prototype.Ca.call(this);Dx(this.La(),"waffle-assistant-feedback-dialog");var a=this.L.length,b=this.R.Wsa();var c=this.ma;var d="";if(0<a){d+='<div class="'+U("waffle-assistant-feedback-dialog-header")+'">';d=d+'Recent suggestions</div><div class="'+(U("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control")+'">');a=Math.max(0,Math.ceil(a));for(var e=0;e<a;e++){var f=e;d+=AWf({name:"waffle-assistant-feedback-dialog-suggestions-radio-buttons",bU:"",checked:f==b,index:f})}d+=
"</div>"}d+='<div class="'+U("waffle-assistant-feedback-dialog-header")+'">';d+="Issue</div>";if(0<c.length){d+='<div class="'+U("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")+'">';b=c.length;for(a=0;a<b;a++)d+=AWf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",bU:c[a],checked:!1,index:a});d+=AWf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",bU:"Other",checked:!1,index:c.length});d+="</div>"}d+='<div class="'+U("waffle-assistant-feedback-dialog-other-feedback-textarea-wrapper")+
'"><textarea class="'+U("waffle-assistant-feedback-dialog-other-feedback-textarea")+" "+U("jfk-textinput")+'" placeholder="'+U("Tell us a bit more")+'"></textarea></div>';c=T(d);Tx(this,cx(c));c=Vx(this);this.oa().Js(c,ny(BWf),0)};
m.Ia=function(){var a=this;cS.prototype.Ia.call(this);if(0<this.L.length){this.O=f9e("waffle-assistant-feedback-dialog-suggestions-radio-buttons",this.Fa("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control"));this.qa(this.O);for(var b=0;b<this.L.length;b++){var c=this.L[b];FW(this.O,b).QI(this.R.render(c))}}0<this.ma.length&&(this.V=f9e("waffle-assistant-feedback-dialog-feedback-radio-buttons",this.Fa("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")),this.qa(this.V));
b=this.Fa("waffle-assistant-feedback-dialog-product-info-display-text");c=new Iy(b);this.qa(c);this.getHandler().listen(b,"click",this.cTa).listen(c,"key",function(d){13===d.keyCode&&(a.cTa(),d.stopPropagation())})};m.dA=function(){var a=DWf(this);fub.qb(a,a.PZa);var b=this.R.gea();b&&b(a);cS.prototype.dA.call(this)};
function DWf(a){var b=null;a.O&&(b=parseInt(b9e(a.O),10)-1,b=a.L[b]);var c=-1;a.V&&(c=parseInt(b9e(a.V),10)-1);var d=a.Fa("waffle-assistant-feedback-dialog-other-feedback-textarea");d=Md(d.value)||"[No feedback entered]";return a.R.Pza(b,c,d)}m.cTa=function(){var a=this,b=DWf(this).jja;this.H=new zWf(b,this.oa());this.H.setVisible(!0);this.getHandler().listen(this.H,"hide",function(){Tf(a.H);a.H=null})};m.Ka=function(){cS.prototype.Ka.call(this);Tf(this.H)};
function EWf(){return T('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function FWf(a,b){return T(R(bA({hd:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:hx(""+R(CB({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(bA({hd:"waffle-assistant-zoom-button",content:hx(""+R(CB({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}function GWf(a,b,c,d){Q.call(this,d);this.O=a;this.D=b;this.C=c;fz(bz(new az,10))}r(GWf,Q);
GWf.prototype.PQa=function(a,b){this.F(this.O,2746,a,b)};
function HWf(a){var b=a.Elb,c='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">',d='By <span class="waffle-assistant-facet-title">'+(R(a.deb)+"</span>");a=0==b.length;c=c+d+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(a)b=T('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');else{d=
'<div class="waffle-assistant-facet-charts-container">';for(var e=b.length,f=0;f<e;f++){var h=b[f];d+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';d=h?d+R(h):d+"(empty)";d+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}b=T(d+"</div>")}c+='<div class="waffle-assistant-facet-content-wrapper'+(a?" waffle-assistant-facet-white-section":"")+'">'+
b+(sC?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return T(c)}function IWf(){g1c.apply(this,arguments)}r(IWf,g1c);IWf.prototype.Hta=g("element");function JWf(){W0c.call(this);X0c(this,this);this.va="waffle-assistant-dragged-card"}r(JWf,hQ);JWf.prototype.contains=function(a){return!!$c(this.F,function(b){if(b.element==a)return!0})};
JWf.prototype.k5=function(a){var b=hQ.prototype.k5.call(this,a);a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0);return b};function KWf(a,b,c,d,e,f,h,k,l,n){GWf.call(this,e,f,h,n);this.V=a;this.L=b;this.ma=c;this.H=d;this.R=k;this.J=l}r(KWf,GWf);KWf.prototype.Ia=function(){GWf.prototype.Ia.call(this);B9e(this.ma,this.La(),this.D,this.C,void 0,void 0,this.H)};
KWf.prototype.F=function(a,b,c,d){jI(this.V).dispatchEvent(new o8e(this.L.copy(),this.H,a,b,c,d,void 0,this.R,this.J))};function LWf(a,b,c,d,e,f){GWf.call(this,c,d,e,f);this.R=a;this.J=b;this.H=null}r(LWf,GWf);LWf.prototype.Ia=function(){GWf.prototype.Ia.call(this);(new HV(foc,this.J.Ql)).send(u(this.L,this,this.J))};LWf.prototype.F=function(a,b,c,d){this.dispatchEvent(new p8e(this.R.clone(),a,this.H,b,c,d))};
LWf.prototype.L=function(a,b){if(b)if(b.Nk())tL.zK(this.La(),b);else{a.Qj(b.Te());AW(a,a.Te());var c=(b=a.Te())?b.toJSON():null,d=ritz.charts.model.GvizChart.create();d.updateChartWrapperJsonString(a.toJSON());c&&d.updateDataTableJsonString(c);B9e(d,this.La(),this.D,this.C,void 0,void 0,void 0);this.H=b}};
function MWf(a,b,c,d,e,f,h,k){Q.call(this,k);this.C=a;this.Va=b;this.Na=c;this.Sa=d;this.R=e;this.Ja=f;this.Ra=h;this.H=ah(this.C,23);this.O=C(this.C,22);this.F=C(this.C,26);this.V=[];this.Qa=new Hl;this.va=this.L=this.D=null;this.Ba=!1;this.Ea=new cA("",this.oa());this.Ga(this.Ea);this.J=this.ma=null}r(MWf,Q);m=MWf.prototype;m.Ca=function(){Q.prototype.Ca.call(this);this.pb(ny(HWf,{deb:this.F,Elb:this.H}));this.La().style.visibility="hidden"};
m.Ia=function(){Q.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-facet-toggle");this.Ea.Wa(a);this.getHandler().listen(this.La(),"mousedown",this.yYb).listen(this.Ea,"action",this.EMb);sC&&(this.va=new N6e("assistantAutovisFacetFeedback",null,"",this.oa()),this.va.render(this.Fa("waffle-assistant-facet-feedback-container")),this.D=new S6e(this.oa()),this.Ga(this.D),this.D.render(this.Fa("waffle-assistant-facet-thumbs-container")),T6e(this.D,this.H.length?"Were these charts useful?":"Was this chart useful?"),
this.getHandler().listen(this.D,"thumbs-up",this.vMb).listen(this.D,"thumbs-down",this.uMb));NWf(this,z(y(),"fefsbd"))};m.Rd=g("Ba");m.yYb=function(a){a.stopPropagation()};m.EMb=function(){var a=Cx(this.Fa("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");NWf(this,a);OWf(this,a?2647:2646)};
function NWf(a,b){var c=a.Fa("waffle-assistant-facet-toggle");Cp(c,b?"HIDE":"SHOW");Hx(a.Fa("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);$c(a.Vf("waffle-assistant-faceted-chart"),function(e){Dp(e,b)});a.D&&P(a.D.La(),b);var d='Show chart broken down by "'+(a.F+'"');a='Hide chart broken down by "'+(a.F+'"');hW(c,b?a:d)}
function PWf(a,b){var c=a.Vf("waffle-assistant-faceted-chart");1==c.length&&2==b.getTypeOrdinal()&&b.setStackingType(1);var d=C(a.C,28).clone();$g(d,1);for(var e=ah(a.C,27),f=0;f<e.length;f++)d.addRange(e[f]);for(e=0;e<c.length;e++){f="string"===typeof a.H[e]?a.H[e]:null;var h=b.copy();f?h.setFilter(a.O,f):h.setFacet(a.O,[a.O-1]);var k=a,l=h.getTitle();l||(l=g5e(h));h.setTitle(QWf(k,l,f));k=h.copy();l=Jl(a.Qa.sb(d),qg);k.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(l));D9e(k);l=new KWf(a.Va,
h,k,d,a.Na,a.Sa,a.R,a.C.getSource(),a.Ra,a.oa());a.Ga(l);var n=c[e];l.Wa(n);a.V.push(l);RWf(a,n,g5e(h),f);a.ma=k}SWf(a);a.La().style.visibility="visible"}function RWf(a,b,c,d){var e=c+(' broken down by "'+(a.F+('" for "'+(d+'"'))));a=c+(' broken down by "'+(a.F+'"'));zx(b,d?e:a)}function QWf(a,b,c){var d=b+(' when "'+(a.F+('" is "'+(c+'"'))));a=b+(' by "'+(a.F+'"'));return c?d:a}
function TWf(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.Fe()&&a.setOption("isStacked",!0)}function UWf(a){"BarChart"==a.Fe()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function SWf(a){a.Ba||$c(a.V,function(b){var c=b.La();if(!a.Ja.contains(c)){var d=a.Ja;b=new IWf(c,b);Y2c(d,b)}})}m.vMb=function(){OWf(this,2649)};m.uMb=function(){OWf(this,2648);this.va.show(!0)};function OWf(a,b){if(a.ma)zxd(a.R,b,new hR,10,a.ma,C(a.C,28));else if(a.J){var c=a.R,d=new hR,e=a.J.Fe();d.F=e;(e=a.J.Te())?d.C=e.clone():d.C=null;Exd(c,b,d,10,a.J,a.J.Ql)}}
function VWf(a,b,c,d,e,f,h,k){kW.call(this,a,k);this.J=zV(a);this.L=b;this.ob=c;this.rb=d;this.R=e;this.Sa=f;this.wb=h;this.ma=new cA("",this.oa());this.Ga(this.ma);this.va=new cA("",this.oa());this.Ga(this.va);this.Ra=new Hl;this.fb=null;this.Na=!1;this.Xa=[];this.Va=[];this.bb=[];this.Ja=this.C=this.D=this.Ba=null;this.Qa=[];a=T5e(this.wb,cI(b));this.F=fz(cz(bz(new az,10),a))}r(VWf,kW);m=VWf.prototype;m.vC=function(a){var b=this;this.isDisposed()||(ritz_api.ChartsApi?(this.fb=a,WWf(this)):ritz_api.RitzEntryPoint.loadChartsApi(function(){b.vC(a)}))};
m.oD=function(){var a=this;if(!this.isDisposed())if(z(y(),"fecpmr"))if(ritz_api.ChartsApi){var b=k5e(this.createChartModel(),C(this.J,28));zx(this.La(),b)}else ritz_api.RitzEntryPoint.loadChartsApi(function(){a.oD()});else XWf(this,function(c){c&&(c=l5e(a.L,c),zx(a.La(),c))},!1)};m.eJ=ea(!0);m.cE=ea("autovisFeedback");m.QH=ea(2208);m.OH=ea(2207);m.jea=ea("Was this chart useful?");
m.Ca=function(){kW.prototype.Ca.call(this);lW(this).appendChild(ny(EWf));W6e(this).appendChild(ny(FWf));if(Xg(this.J,22)){this.C=new MWf(this.J,this.L,this.V,this.rb,this.R,this.Sa,this.Qa,this.oa());this.Ga(this.C,!0);var a=this.C,b=this.Rd();a.Ba=b;SWf(a)}};
m.Ia=function(){kW.prototype.Ia.call(this);Dx(this.La(),"waffle-assistant-card-draggable");var a=this.Fa("waffle-assistant-insert-chart-button");this.ma.Wa(a);hW(a,"Insert chart");a=this.Fa("waffle-assistant-zoom-button");this.va.Wa(a);hW(a,"View full size");a=this.Fa("waffle-assistant-before-chart-preview");var b=this.Fa("waffle-assistant-after-chart-preview");this.getHandler().listen(this.La(),"keydown",this.wYb).listen(a,"focus",this.tsb).listen(b,"focus",this.krb).listen(this.ma,"action",this.pBb).listen(this.ma.La(),
"mousedown",this.aza).listen(this.va,"action",this.wOb).listen(this.va.La(),"mousedown",this.aza).listen(this.Fa("waffle-assistant-chart-highlights"),"mousedown",this.aza).listen(nG(this.L),"hc",this.xYb);YWf(this);this.R.C(2790,this.F);this.C&&this.R.C(2791,this.F)};m.px=function(a){kW.prototype.px.call(this,a);YWf(this);this.tb()&&ZWf(this)};function YWf(a){if(a.tb()){var b=a.Rd();a.ma.setVisible(!b);a=a.oa().Fa("waffle-assistant-button-separator",W6e(a));P(a,!b)}}
m.wYb=function(a){13==a.keyCode&&a.target==this.La()&&(a.preventDefault(),a.stopPropagation(),$Wf(this,2255))};
function aXf(a){var b=a.Fe(),c=!!C(a.J,14),d=C(a.J,16),e=!!C(a.J,15),f="Histogram"==b;b="PieChart"==b;var h=to(ah(a.H,4));if(!h[0]||h[0].C==cI(a.L)){for(var k=1<h.length,l=[],n=0;n<h.length;n++){var q=h[n].rect;q=c!=b?kCa(q,new an(q.width,1)):kCa(q,new an(1,q.height));ud(l,q)}c=vJ(a.ob).F;var t=[];for(w in UBa)t.push(wxc(c,UBa[w]));var w=cd(l,function(x){return cd(t,La(vn,x))});f&&e&&(w=vd(w,1));a.bb=bXf(w.length,b&&0<d||!f&&!b&&e,b&&k);d=vJ(a.ob);for(e=0;e<w.length;e++)for(f=a.bb[e],b=0;b<w[e].length;b++)w[e][b]&&
Hn(w[e][b])&&(k=u0e(d,w[e][b],"waffle-assistant-styled-rect"),a.qa(k),MO(d.V,"default",k,!0),nw(k.La(),"background-color",f),k.setVisible(!0),a.Xa.push(k),k=PO(d,w[e][b],"waffle-assistant-styled-border",1,0),a.qa(k),Fzc(k,f),k.setVisible(!0),a.Va.push(k))}}function cXf(a){Uf(a.Xa);Uf(a.Va);a.Xa=[];a.Va=[];a.bb=[]}m.xYb=function(){this.Na&&(cXf(this),aXf(this))};m.oT=function(){kW.prototype.oT.call(this);this.Ja=Oa();this.Na||(aXf(this),this.Na=!0)};
m.NN=function(){kW.prototype.NN.call(this);"number"===typeof this.Ja&&500<Oa()-this.Ja&&this.R.C(2789,this.F);this.Ja=null;cXf(this);this.Na=!1};m.tsb=function(){var a=this.Fa("waffle-assistant-chart-highlights");Kw(a)?a.focus():this.La().nextSibling&&this.La().nextSibling.focus()};m.krb=function(){this.O&&O6e(this.O)||this.va.La().focus()};m.pBb=function(){$Wf(this,2255)};m.aza=function(a){a.stopPropagation()};m.wOb=function(){Aub.qb(this,this.F)};m.PQa=function(a,b){$Wf(this,2257,a,b)};
function $Wf(a,b,c,d){if(z(y(),"fecpmr")){var e=a.createChartModel();jI(a.L).dispatchEvent(new o8e(e,C(a.J,28),a.V,b,c,d,Hk(a.F),a.J.getSource(),a.Qa))}else XWf(a,function(f){f&&(f=new p8e(f,a.V,a.D&&a.D.Te(),b,c,d,Hk(a.F),a.J.getSource(),a.Qa),jI(a.L).dispatchEvent(f))},!1)}function dXf(a,b){B9e(b,eXf(a),a.rb,a.R,function(){null!==a.Ba&&(hl(dl(),a.Ba),a.Ba=null);a.isDisposed()||(a.fb(),ZWf(a))})}function ZWf(a){if(!a.Rd()){var b=eXf(a);if(!a.Sa.contains(b)){var c=a.Sa;a=new IWf(b,a);Y2c(c,a)}}}
function fXf(a,b,c){var d=[];try{var e=a.Ra.sb(c),f=Jl(e,qg),h=ritz_api.RitzModelApi.getVerbalHighlightsForProto(f,ritz.charts.model.ChartTypes.toGviz(b.getTypeOrdinal()),0!=b.getStackingTypeOrdinal(),b.getTitle(),YW(b,ritz.charts.model.AxisNames.X),YW(b,ritz.charts.model.AxisNames.Y),YW(b,ritz.charts.model.AxisNames.RIGHT),b.getDomainDataBacked());d=cd(h,Bcf)}catch(k){d=[]}a=a.Fa("waffle-assistant-chart-highlights");P(a,0<d.length);0<d.length&&(a.appendChild(d[0]),Dp(a,!0))}
m.createChartModel=function(){gXf(this);var a=ritz.charts.model.ChartImpl.create(),b=C(this.J,28);ritz_api.ChartsApi.setChartModel(a,Jl(this.Ra.sb(b.ol()),hg));b=Jl(this.Ra.sb(b),qg);a.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(b));return a};function hXf(a){gXf(a);C(a.J,16);var b=P7e(a.J);b.FCa(foc);var c=z7e(a.H);b.vp(c.toString());a.C&&(c=c.clone(),a.C.L=c);return b}function gXf(a){a.$d&&(a.Ba=gl(dl(),"aaoar"),a.$d=!1)}
function WWf(a){if(z(y(),"fecpmr")){var b=a.createChartModel(),c=b.copy();D9e(c);fXf(a,b,C(a.J,28));dXf(a,c);a.C&&PWf(a.C,b)}else{var d=Q7e(hXf(a),a.Fa("waffle-assistant-card-inner"));(new HV(foc,d.Ql)).send(function(e){if(e)if(e.Nk())tL.zK(eXf(a),e);else{d.Qj(e.Te());AW(d,d.Te());e=new Vs;e.setContext(d.toJSON());var f=!!C(a.J,14);D(e,3,f);var h=C(a.J,16);D(e,4,h);D(e,5,f);D(e,8,0);C(a.J,24)&&(f=C(a.J,25),D(e,9,f));f=to(ah(a.H,4));for(h=0;h<f.length;h++)e.addRange(qo(f[h].rect,f[h].C));f=(f=d.Te())?
f.toJSON():null;h=ritz.charts.model.GvizChart.create();h.updateChartWrapperJsonString(d.toJSON());f&&h.updateDataTableJsonString(f);fXf(a,h,e);a.D=d;e=(e=d.Te())?e.toJSON():null;f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);dXf(a,f)}});a.C&&XWf(a,function(e){var f=a.C,h=d;e=new AL(e.toJSON());h=new AL(h.toJSON());var k=f.Vf("waffle-assistant-faceted-chart");if(1<k.length){UWf(e);var l=h;TWf(l);l.setOption("pieSliceText","percentage");
l.setOption("axisFontSize",0);l.setOption("hAxis.title",null);l.setOption("hAxis.textPosition","none");l.setOption("vAxes.0.title",null);l.setOption("vAxes.0.textPosition","none");l.setOption("vAxes.1.title",null);l.setOption("vAxes.1.textPosition","none");l.setOption("legend","none");l.setOption("titleTextStyle.fontSize",0)}else l=e,UWf(l),l.setOption("applyAggregateData",void 0),l.setOption("legend","right"),TWf(h);l=to(ah(f.C,27));goc(f.L,l);l=C(f.C,25);for(var n=0;n<k.length;n++){var q="string"===
typeof f.H[n]?f.H[n]:null,t=l.clone(),w=f.O,x=new IWa;D(x,1,w);"string"===typeof q&&x.setValue(q);D(t,7,x);f.L.Ob("dt",encodeURIComponent(JSON.stringify(f.Qa.sb(t))));t=new AL(e.toJSON());t.vp(f.L.toString());w=h.clone();w.vp(f.L.toString());x=f;var F=t.getOption("title");F||(F=h5e(t));x=QWf(x,F,q);t.setOption("title",x);w.setOption("title",x);x=new LWf(t,w,f.Na,f.Sa,f.R,f.oa());f.Ga(x);F=k[n];x.Wa(F);f.V.push(x);RWf(f,F,h5e(t),q);f.J=w}SWf(f);f.La().style.visibility="visible"},!1)}}
function XWf(a,b,c){var d=hXf(a);(new HV(foc,d.Ql)).send(function(e){e?(e=e.Te(),c&&d.Qj(e),AW(d,e),b(d)):b(null)})}m.Fe=function(){return this.J.Fe()};function bXf(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=N7e("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&ud(d,d);return d}function eXf(a){return a.Fa("waffle-assistant-chart-preview")}
function iXf(a,b){a=a.title;var c='<div class="waffle-assistant-feature-section" tabindex="0" role="region" aria-label="',d=" "+(U(a)+" section ");c+=jx(d);c+='"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+R(a)+"</div>";c+=R(bA({hd:"waffle-assistant-section-more-button",content:hx("More"),style:4},b));return T(c+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>')}
function d_(a,b,c,d){Q.call(this,d);this.V=a;this.bb=b;this.va=new cA("",this.oa());this.Ga(this.va);this.L=new Q(this.oa());this.Ga(this.L);this.C=null;this.Qa=[];this.ma=this.Na=!1;this.R=c}r(d_,Q);m=d_.prototype;m.GTa=ea(!1);m.nDa=ea(!0);m.Ca=function(){Q.prototype.Ca.call(this);this.pb(ny(iXf,{title:this.getTitle()}))};
m.Ia=function(){Q.prototype.Ia.call(this);this.L.Wa(this.Fa("waffle-assistant-section-card-holder"));this.va.Wa(this.Fa("waffle-assistant-section-more-button"));this.getHandler().listen(this.va,"action",this.CDb);this.C=this.FJa();this.qa(this.C);P(jXf(this),this.GTa());this.setVisible(!1)};m.setVisible=function(a){this.tb()&&this.isVisible()!=a&&(P(this.La(),a),a&&(P(this.va.La(),this.a4a()),a=new ok,a=L(a,4,this.O7()),a=sk(new lk,a),a=fz(cz(bz(new az,10),a)),this.R.C(2774,a)))};
m.isVisible=function(){return this.tb()&&Kw(this.La())};m.a4a=function(){return this.Qa.length>this.V};m.FJa=function(){return new JW(this.oa())};m.rT=function(a){this.ma=a;$c(kXf(this),function(b){b.px(a)});Maf(this.C,a)};m.Rd=g("ma");m.OXa=ba();
m.pT=function(a){this.Qa=a;for(var b=0;b<a.length;b++){if(this.L.tc()<this.V){var c=this.FW(a[b]);c.px(this.ma);var d=this.L.tc();c.V=d;this.L.Ga(c,!0)}if(this.nDa()&&(this.C.WJ(!1),c=this.FW(a[b]),c.px(this.ma),d=this.C,d.C.push(c),d.Ad)){Kaf(d,!1);var e=d.O.tc();c.V=e;d.O.Ga(c,!0);c.CQ()}}};function kXf(a){var b=[];a.L.Ye(function(c){b.push(c)});return b}function jXf(a){return a.Fa("waffle-assistant-section-content")}m.Zva=function(){return this.L.b6()};
m.qT=function(){this.Qa=[];Uf(this.L.yd(!0));this.setVisible(!1);this.nDa()&&(this.C.M2(),this.C.WJ(!0))};function lXf(a){a.L.Ye(function(b,c){c<this.V&&b.CQ()},a)}m.P7=function(a){var b=0;if(this.Na)this.C.PXa();else if(this.Zva()){this.setVisible(!0);b=Hw(this.Fa("waffle-assistant-section-header")).height+Hw(jXf(this)).height;for(var c=kXf(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.eQa(c[d]),Y6e(c[d],!0),b+=Hw(c[d].La()).height):Y6e(c[d],!1)}else this.setVisible(!1);return a-b};m.eQa=ba();
m.setActive=function(a){(this.Na=a)||this.C.Yba()};m.Gb=g("Na");m.uo=function(a){this.C&&Kaf(this.C,a)};function mXf(a,b){a.C.Eka(b,a.getTitle())}m.CDb=function(){this.setActive(!0);this.dispatchEvent("ge")};function nXf(){return T('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')}function oXf(a,b){kW.call(this,a,b);this.C=zV(a)}r(oXf,kW);m=oXf.prototype;m.oD=ba();m.cE=ea("assistantWordCloudFeedback");
m.QH=ea(2634);m.OH=ea(2633);m.Ca=function(){kW.prototype.Ca.call(this);lW(this).appendChild(ny(nXf));Dx(lW(this),"waffle-assistant-word-cloud-content-container")};m.vC=function(a){for(var b=ah(this.C,19),c=ah(this.C,20),d=this.Fa("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(pXf(this,b,c,e),120<d.clientHeight){pXf(this,b,c,e-1);break}b=this.oa();c=C(this.C,2);c=Mp(b,c);d=this.Fa("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function pXf(a,b,c,d){var e=a.Fa("waffle-assistant-word-cloud-words-container");for(a=a.oa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Mp(a," "));var l=a.createElement("SPAN");a.appendChild(l,Mp(a,b[k]));a.appendChild(e,l);Dx(l,"waffle-assistant-word-cloud-word");var n=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(n-f)/(h-f)*15+9+"px"}}
function qXf(a,b,c,d,e,f){var h=Uc(y(),"fmnac");h||(h=20);d_.call(this,h,e,d,f);this.Ba=a;this.H=b;this.Ea=c;this.D=new JWf;this.qa(this.D);this.F=null;this.O=0;this.J=null}r(qXf,d_);m=qXf.prototype;m.Ia=function(){d_.prototype.Ia.call(this);this.D.init();this.getHandler().listen(this.D,"drag",this.vYb).listen(this.D,"dragend",this.Vm)};m.getTitle=ea("Analysis");m.v2=function(a){return 0==a};
m.FW=function(a){return"WordCloud"==zV(a).Fe()?new oXf(a,this.oa()):new VWf(a,this.Ba,this.H,this.Ea,this.R,this.D,this.J,this.oa())};m.rT=function(a){d_.prototype.rT.call(this,a);a&&$0c(this.D)};m.eQa=function(a){this.getHandler().Nc(a,"content-rendered",this.uYb);this.O++};m.pT=function(a,b){this.J=b||null;d_.prototype.pT.call(this,a,b);var c=a.map(function(d){return zV(d).Fe()});$c(kXf(this),function(d){d instanceof VWf&&(d.Qa=c)})};m.uYb=function(){0==--this.O&&this.dispatchEvent("ce")};
m.vYb=function(){this.F=Dw(this.D.Uc.target)};m.Vm=function(a){var b=this.F,c=vJ(this.H).D;if(en(GN(c,"page",!1,!1)).contains(b)){var d=EN(c,b.x,b.y,"page");c=HN(c,d,"page");b=new Vm(b.x-c.left,b.y-c.top);a.C.getData().PQa(d,b)}this.F=null};m.O7=ea(2);
function rXf(a,b){a=T;var c='<div class="'+U("waffle-assistant-answers-logging-message-container")+'"><div class="'+U("waffle-assistant-answers-logging-message")+'"><span class="'+U("waffle-assistant-answers-logging-text")+'">';c=c+"We're logging your queries and data to improve the feature.</span><div class=\""+(U("waffle-assistant-answers-learn-more")+'">');c=c+'Learn More</div><div class="'+(U("waffle-assistant-answers-logging-opt-out")+'">');c=T(c+"Opt out for this file</div></div></div>");return a(c+
'<div class="'+U("waffle-assistant-answers-input")+" "+U("waffle-assistant-answers-input-with-icon")+'"><form class="'+U("waffle-assistant-answers-query-box")+'">'+R(haf(b))+"</form></div>")}
function sXf(a,b,c,d,e,f,h,k,l,n){d_.call(this,1,f,e,n);this.Xa=c;this.fb=b;this.Ja=null;this.Ea=new jz("",new ZQ,this.oa());this.Ga(this.Ea);this.Sa=new jz("",new ZQ,this.oa());this.Ga(this.Sa);f=new YN(a,!0,!0);f=new g8e(f);this.Ba=new a7e(e);this.O=new Jbf(this.Xa,f,e);this.H=new Nbf(this.O,a,b,c,d,e,this.bb,f,this.Ba,h,k,l,this.oa());this.D=new uW(b,"waffle-assistant-answers-styled-border","waffle-assistant-answers-styled-rect");this.qa(this.D);this.F=this.J=null;this.Va=fz(bz(new az,10));this.Ra=
!1}r(sXf,d_);m=sXf.prototype;m.Ca=function(){d_.prototype.Ca.call(this);var a=ny(rXf);this.oa().appendChild(jXf(this),a)};
m.Ia=function(){d_.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-answers-query-box"),b=this.Fa("waffle-assistant-answers-input-box");this.Sa.Wa(this.Fa("waffle-assistant-answers-logging-opt-out"));this.Ea.Wa(this.Fa("waffle-assistant-answers-learn-more"));this.getHandler().listen(a,"focus",this.sHb,!0).listen(a,"blur",this.qHb,!0).listen(a,"mouseover",this.uHb).listen(a,"mouseout",this.tHb).listen(a,"click",this.rHb).listen(b,"input",this.FYb).listen(this.Sa,"action",this.yFb).listen(this.Ea,
"action",this.WBb).listen(nG(this.Xa),"hc",U0e(this.GYb,25,this));this.setVisible(null!=this.J);tXf(this,zrb&&Arb&&tC("showAnswersLoggingOptOut"))};m.a4a=ea(!1);m.GTa=ea(!0);m.nDa=ea(!1);m.getTitle=ea("Answers");m.O7=ea(1);m.v2=function(a){return 3==a||0==a||1==a};
m.pT=function(a,b){zd(a,function(l,n){return C(n,2)-C(l,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=bh(a[f],1);3==h?e=a[f]:0==h?c.push(zV(a[f])):1==h&&d.push(a[f])}if(e&&C(e,2)){f=b||null;h=Xg(e,11)?C(e,11):null;var k=null==h?null:ro(C(e,10));0<Yg(e,4)?uXf(this,ro(yV(e)),C(e,9),k,h,c,d):uXf(this,f,C(e,9),k,h,c,d);this.F||(d_.prototype.pT.call(this,a,b),this.getHandler().listen(this.F,"sqc",this.KLb))}else this.qT(!0)};
m.FW=function(a){if(!this.F){var b=rbf(this.O,3);this.F=new Hbf(a,this.fb,this.R,this.Ba,b,Dbf,"regular",void 0,this.oa())}return this.F};m.FJa=g("H");m.Zva=function(){return this.isVisible()};m.qT=function(a,b,c){this.O.reset();(a||b)&&this.F&&(d_.prototype.qT.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||void 0!==b&&!b)this.F&&(d_.prototype.qT.call(this,a,b,c),this.F.dispose(),this.F=null),this.tb()&&(this.O.reset(),this.J=null,Tbf(this.H),this.setVisible(!1),this.Gb()&&vW(this.D));c&&this.H.reset()};
m.uo=function(a,b){b||Kaf(this.H,a)};m.OXa=function(a){this.Ja=a;var b=this.H;b.Qa=a;b.va.cF(a);b.Ea.cF(a);this.O.L=a;this.Ba.C=a};m.setActive=function(a){d_.prototype.setActive.call(this,a);a?wW(this.D,this.J):vW(this.D)};function vXf(a,b){a.Gb()&&(b?vW(a.D):wW(a.D,a.J))}function tXf(a,b){P(a.Fa("waffle-assistant-answers-logging-message-container"),b)}function wXf(a,b){a=a.Fa("waffle-assistant-answers-query-box");Hx(a,"waffle-assistant-answers-query-box-focused",b)}
m.GYb=function(){this.Gb()&&wW(this.D,this.J)};m.sHb=function(){wXf(this,!0);wW(this.D,this.J)};m.qHb=function(){wXf(this,!1);this.Gb()||vW(this.D)};m.uHb=function(){wW(this.D,this.J)};m.tHb=function(){this.Gb()||vW(this.D)};m.rHb=function(){xXf(this,"")};m.FYb=function(){var a=this.Fa("waffle-assistant-answers-input-box");ef(a.value)||(xXf(this,a.value),a.value="")};m.KLb=function(a){xXf(this,a.C,!1,!0,a);this.R.C(2652,this.Va)};
function xXf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;a.setActive(!0);a.dispatchEvent("ge");yXf(a,b,c);if(d&&b){var f=new GS;e instanceof Bbf?f=Y5e(1,e.F,e.D,1):e instanceof naf&&(f=fcf(e));c=new Rq(function(){Sbf(a.H,b,f,e)},300);a.qa(c);c.start()}}function yXf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;var f=new Rq(function(){var h=a.H;h.D&&yaf(h.D,b,!0);h=a.H;var k=c||!1;h.Xe=k;h.qd.R=k;h.Cc.R=k;d&&b&&(h=new GS,e&&(h=fcf(e)),Sbf(a.H,b,h,e))},300);a.qa(f);f.start()}
function uXf(a,b,c,d,e,f,h){c=c||new cJ;a.J=b;a.O.init(c,b,d,e,f,h);a.O.j_();a.O.k_().then(function(k){var l=a.cb("waffle-assistant-answers-input-box");l&&0<k.length&&z(y(),"feaipu")&&l.setAttribute("placeholder",saf(k[0].query))},null,a);a.setVisible(null!=b);Qbf(a.H,b,c,d,e,a.Ra,f);a.Ra=!1;a.Gb()&&wW(a.D,a.J)}m.yFb=function(a){a.stopPropagation();a.preventDefault();this.Ja&&(jr(Sl(Tl(this.Ja.$e("/answers/logoptout"),u(this.zCb,this)),u(this.yCb,this)),"POST").Se(),this.R.C(2663,this.Va))};
m.WBb=function(a){a.stopPropagation();a.preventDefault();Zw("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};m.zCb=function(a){a.Uj()&&tXf(this,!1)};m.yCb=ba();
function zXf(a,b){a=T;b=""+R(bA({hd:"waffle-assistant-datavalidation-apply-button",content:"Apply",style:4},b));b=T(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function AXf(a){return T('<div class="waffle-assistant-datavalidation-detail-chip">'+R(a.Cfb)+"</div>")}
function BXf(a,b,c,d){kW.call(this,a,d);this.D=new uW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.D);this.C=new cA("",this.oa());this.Ga(this.C);this.F=yV(a);this.L=c}r(BXf,kW);m=BXf.prototype;m.Ca=function(){kW.prototype.Ca.call(this);lW(this).appendChild(ny(zXf))};
m.Ia=function(){kW.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-datavalidation-apply-button");this.C.Wa(a);hW(a,"Apply data validation");this.getHandler().listen(this.C,"action",this.Jrb).listen(this.La(),"mouseenter",this.$Yb).listen(this.La(),"mouseleave",this.aZb);a=xXe(new ok,Qcf(Hh(C(C(this.H,13),3))));a=sk(new lk,a);a=fz(cz(bz(new az,10),a));this.L.C(35577,a)};
m.vC=function(a){var b=cM(so(this.F)),c=C(C(this.H,13),3);switch(Hh(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=Ih(c).map(function(k){return C(k.Wn().getValue(),2)});break;case 1:d="Numerical validation";c=["Greater than "+C(Ih(c)[0].Wn().getValue(),3)];break;case 7:d="Numerical validation";c=Ih(c);c=["Between "+(C(c[0].Wn().getValue(),3)+(" and "+
C(c[1].Wn().getValue(),3)))];break;case 5:d="Numerical validation";c=Ih(c);c=["Equal to "+C(c[0].Wn().getValue(),3)];break;default:d="unrecognized",c=[]}var e=new pC,f=e.text(d)+(" for "+(e.bd("SPAN".toString(),{XG:"waffle-assistant-datavalidation-range"})+e.text(b)+e.ad("SPAN".toString())));Lga(this.Fa("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Fa("waffle-assistant-datavalidation-details");$c(c,function(k){k=ny(AXf,{Cfb:k});h.appendChild(k)});b="Suggested data validation: "+
(d+(" "+(c.join()+(" for "+b))));zx(this.La(),b);a()};m.oD=ba();m.cE=ea("assistantDataValidationFeedback");m.QH=ea(35551);m.OH=ea(35550);m.Jrb=function(){this.dispatchEvent(new jW("$d",this,35549))};m.$Yb=function(){wW(this.D,ro(this.F))};m.aZb=function(){vW(this.D)};function CXf(a,b,c,d){d_.call(this,1,b,a,d);this.D=c}r(CXf,d_);m=CXf.prototype;m.getTitle=ea("Data validation");m.v2=function(a){return 6==a};
m.FW=function(a){var b=C(a,1);switch(b){case 6:return new BXf(a,this.D,this.R,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.rT=function(a){d_.prototype.rT.call(this,a);this.setVisible(!a)};m.P7=function(a){return this.Rd()?(this.setVisible(!1),a):d_.prototype.P7.call(this,a)};m.O7=ea(4);function DXf(a,b,c){jW.call(this,"Yd",a,b);this.D=c}r(DXf,jW);function EXf(a){a=""+R(bA({hd:"waffle-assistant-formatting-edit-button",content:"Edit",style:4},a));return T(a)}
function FXf(a,b){a='<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colours for <span class="waffle-assistant-banding-range"></span></div>'+(EXf(b)+"</div>");return T(a)}
function GXf(a,b){return T('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+EXf(b)+"</div>")}function HXf(a,b,c){jW.call(this,"fe",a,b);this.D=c}r(HXf,jW);function IXf(a,b,c,d){kW.call(this,a,d);a=cd(ah(this.H,7),Ucf);this.C=new Zcf(!1,a,7);this.Ga(this.C);this.L=new cA("",this.oa());this.Ga(this.L);this.ma=b;this.F=!1;this.D=-1;this.R=c}
r(IXf,kW);m=IXf.prototype;m.Ca=function(){kW.prototype.Ca.call(this);lW(this).appendChild(ny(FXf))};m.Ia=function(){kW.prototype.Ia.call(this);this.getHandler().listen(this.L,"action",this.Gxb).listen(this.C,"Ze",this.osb);this.ma.C(2768)};
m.vC=function(a){var b=this.Fa("waffle-assistant-banding-color-picker-container");this.C.render(b);$cf(this.C);b=this.Fa("waffle-assistant-banding-range");var c=yV(this.H),d=so(c);Cp(b,cM(d));JXf(this,c);b=this.Fa("waffle-assistant-formatting-edit-button");this.L.Wa(b);a()};m.oD=function(){zx(this.La(),"Suggested alternating background colours");this.C.Ee("Choose a colour scheme")};m.cE=ea("assistantBandingFeedback");m.QH=ea(2672);m.OH=ea(2671);
m.Gxb=function(a){mJ.dispatchEvent({type:"show-banding-pane-recommendation",A1a:this.H,Zeb:bdf(this.C)});a.stopPropagation()};m.osb=function(a){var b=this;if(!this.F&&adf(this.C)){var c=this.D;this.D=this.C.ji();this.D==c?this.dispatchEvent(new HXf(this,2797,function(){b.R.clear()})):this.dispatchEvent(new DXf(this,2673,function(){E8e(b.R,"Alternating colours applied",b.oa(),function(){b.dispatchEvent(new jW("ke",b,2796))})}));a.stopPropagation()}};
function JXf(a,b){a.F=!0;var c=b.gb();b=so(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.kc(),b.Qb(),b.Sc(),b.Wc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=Il(c,xia),c=(new Hl).Qd(ct.getDescriptor(),c),c=Ucf(c)):c=null;c?(c=cdf(a.C,c),HL(a.C,c?c.getElement():null)):HL(a.C,null);a.D=a.C.ji();a.F=!1}function KXf(a,b){Py.call(this,void 0,void 0,b);this.C=a}r(KXf,Py);
KXf.prototype.Jc=function(a){Py.prototype.Jc.call(this,a);var b=this.C.Sd;switch(b.length){case 0:break;case 1:var c="one-rule";break;case 2:case 4:c="two-rules";break;default:c="three-rules"}for(var d=0;d<b.length;d++){var e=b[d],f=jp("DIV");Ex(f,["waffle-assistant-conditionalformat-format-preview",c]);var h=jp("DIV");Dx(h,"waffle-assistant-conditionalformat-format-preview-label");f.appendChild(h);Cp(h,"123");if(Xg(e,2)){var k=C(C(e,2),1);switch(Hh(Kh(k))){case 9:case 13:k=Ih(Kh(k))[0];var l=ah(e,
1)[0];Cp(h,BG(k,bh(l,1),bh(l,2),bh(l,4)))}}odf(e,f);a.appendChild(f)}};KXf.prototype.Vg=function(){var a=this.C;a.dispatchEvent(new jW("Zd",a,2563));return!0};function LXf(a,b){kW.call(this,a,b);this.C=new cA("",this.oa());this.Ga(this.C);this.Sd=ah(a,6)}r(LXf,kW);m=LXf.prototype;m.Ca=function(){kW.prototype.Ca.call(this);lW(this).appendChild(ny(GXf))};
m.Ia=function(){kW.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-formatting-edit-button");this.C.Wa(a);hW(a,"Apply and edit conditional format rules");this.getHandler().listen(this.C,"action",this.Hrb)};m.vC=function(a){Cp(this.Fa("waffle-assistant-conditionalformat-description"),bh(this.H,3));var b=this.Fa("waffle-assistant-conditionalformat-rule-holder"),c=new KXf(this,this.oa());this.Ga(c);c.Wa(b);hW(b,"Apply conditional format rules");a()};m.oD=ba();m.cE=ea("assistantConditionalFormatFeedback");
m.QH=ea(2630);m.OH=ea(2629);m.Hrb=function(){this.dispatchEvent(new jW("Zd",this,2563));this.dispatchEvent(new jW("be",this,2670,void 0,void 0,so(C(this.Sd[0],1,0))));T4b()};function MXf(a,b,c){d_.call(this,2,b,a,c)}r(MXf,d_);m=MXf.prototype;m.getTitle=ea("Formatting");m.v2=function(a){return z(y(),"feecfr")&&2==a||4==a};
m.FW=function(a){var b=C(a,1);switch(b){case 2:return new LXf(a,this.oa());case 4:return new IXf(a,this.R,this.bb,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.rT=function(a){d_.prototype.rT.call(this,a);this.setVisible(!a)};m.P7=function(a){return this.Rd()?(this.setVisible(!1),a):d_.prototype.P7.call(this,a)};m.O7=ea(3);function e_(a,b,c,d,e){Q.call(this);this.R=a;this.Va=b;this.C=c;this.L=d;this.D=e}r(e_,Q);
e_.prototype.Hia=function(a,b,c){this.C=a;this.L=b;this.D=c};e_.prototype.Ia=function(){Q.prototype.Ia.call(this);this.getHandler().listen(this.R.C,"pa",this.Xa)};e_.prototype.Xa=function(){this.Va.qb()};function NXf(a,b,c,d){d=void 0===d?!1:d;jW.call(this,"he",null,2859);this.D=a;this.O=b;this.F=c;this.L=!!d}r(NXf,jW);
function OXf(a,b){A.call(this);this.F=a;this.H=b;this.C=new uW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.qa(this.C);this.D=new uW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.qa(this.D)}r(OXf,A);OXf.prototype.Ka=function(){vW(this.C);vW(this.D);A.prototype.Ka.call(this)};
function PXf(a,b,c,d,e,f){azc(b);var h=hG(d);h=new rn(h.kc(),h.Qb(),Math.min(h.Sc(),h.kc()+6),Math.min(h.Wc(),h.Qb()+6));var k=PN(b),l=vJ(a.F).D,n=FM(l,new jn(h.kc(),h.Sc()),"r",!0,!1,!0,!0)-1,q=FM(l,new jn(h.Qb(),h.Wc()),"c",!0,!1,!0,!0)-1;l.Nb()&&--q;n=Math.min(200,n);q=Math.min(c.offsetWidth-2,q);bzc(b,k,q,n);c=sWf(d,e,f);a.H.render(b,h,c);b=a.C;h=d.kc();k=d.Qb();switch(e){case 0:h=Math.min(d.Sc(),d.kc()+f);break;case 1:k=Math.min(d.Wc(),d.Qb()+f)}d=HRb(d.gb(),h,k,d.Sc(),d.Wc());wW(b,gG(d));wW(a.D,
gG(c))}
function QXf(a){var b=a.a1a,c=a.$0a,d=a.I_a;a=a.eba;return T('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+U(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+R(b)+'</div></div><div class="waffle-tables-popup-content">'+R(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+R(d)+
'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+R(a)+"</div></div></div></div>")}
function RXf(){var a=T('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label><div class="waffle-assistant-tables-edit-sheet-button"></div></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper"><div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+QXf({a1a:"Edit data range",$0a:hx(""+a),I_a:"Update",eba:"Cancel"});return T(a)}function SXf(){var a=""+QXf({a1a:"Improve suggestions",$0a:hx('<div class="waffle-tables-popup-header-message"></div>'),I_a:"No",eba:"Yes"});return T(a)}function TXf(a){a='<div class="waffle-tables-bar-content">For <span class="waffle-assistant-table-bar-range">'+(R(a.hD)+"</span></div>");return T(a)}
function UXf(a){a='Is <span class="waffle-assistant-table-first-header">'+(R(a.sS)+"</span> a header row, containing titles that describe the columns below?");return T(a)}function VXf(a,b,c,d,e,f,h){e_.call(this,a,eDb,d,e,f);this.F=OB(new NB);this.qa(this.F);this.J=new jz("",new YQ,this.oa());this.Ga(this.J);Yz(this.F,this.J,fDb);this.H=new jz("",new YQ,this.oa());this.Ga(this.H);Yz(this.F,this.H,eDb);this.V=new OXf(b,c);this.qa(this.V);this.O=new Uz(this);this.qa(this.O);this.va=h}r(VXf,e_);
VXf.prototype.Ca=function(){this.pb(ny(SXf))};
VXf.prototype.Ia=function(){e_.prototype.Ia.call(this);this.J.Wa(this.Fa("waffle-tables-popup-done"));this.H.Wa(this.Fa("waffle-tables-popup-cancel"));var a=sWf(this.C,this.D,1);a=cM(hG(a));a=ny(UXf,{sS:a});this.Fa("waffle-tables-popup-header-message").appendChild(a);this.O.subscribe(fDb,"action",this.Ba).subscribe(eDb,"action",this.ma);a=this.Fa("waffle-assistant-table-canvas");var b=this.Fa("waffle-assistant-canvas-container");PXf(this.V,a,b,this.C,this.D,this.L);a=this.Fa("waffle-tables-popup");
Hx(a,"waffle-tables-popup-answers-enabled",this.va);b=new JB(a,this.oa());this.qa(b);KB(b);a.focus()};VXf.prototype.ma=function(){this.dispatchEvent("ie")};VXf.prototype.Ba=function(){var a=hG(this.C);switch(this.D){case 0:a=Jn(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=Jn(a.top,a.left+1,a.top+a.height,a.left+a.width)}var b=this.L-1,c=this.C.gb();this.dispatchEvent(new NXf(new Mn(c,a),b,this.D));this.dispatchEvent("ie")};
function WXf(a,b,c,d,e,f,h,k,l,n,q){kW.call(this,l,q);this.Xa=b;this.bb=c;this.Qa=d;this.fb=n;this.Ja=e;this.Sa=h;this.L=new jz("",new YQ,this.oa());this.Ga(this.L);this.ma=new jz("",new YQ,this.oa());this.Ga(this.ma);this.C=this.R=this.F=null;this.Va=this.bb.L.C;this.Ba=fz(bz(new az,66));this.Na=f;this.va=new uW(f,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.va);this.Ra=ah(l,4);this.D=null}r(WXf,kW);m=WXf.prototype;m.eJ=ea(!0);
m.Ca=function(){kW.prototype.Ca.call(this);lW(this).appendChild(ny(tWf));W6e(this).appendChild(ny(uWf))};
m.Ia=function(){var a=this;kW.prototype.Ia.call(this);var b=C(this.H,5);b=k8e(this.Sa,b);this.R=new s8e(b,this.Va,this.fb);b=this.Fa("waffle-assistant-insert-pivottable-button");this.L.Wa(b);hW(b,"Insert pivot table");b=this.Fa("waffle-assistant-zoom-button");this.ma.Wa(b);hW(b,"Preview pivot table");this.getHandler().listen(this.L,"action",function(){XXf(a,35619)}).listen(this.ma,"action",this.TXa);this.px(this.Rd())};
m.vC=function(a){var b=this.oa();b.De(this.Fa("waffle-assistant-answercard-interpret"),bh(this.H,3));this.C=b.Ca("CANVAS","waffle-pivottable-pivot-canvas");b.Vi(this.C,!0);zx(this.C,"Pivot table canvas");var c=this.Fa("waffle-assistant-answercard-pivot-content");b.appendChild(c,this.C);b=C(this.H,5);this.D=new r8e(c,this.Na,this.Xa,this.Qa);this.D.H=b;c=this.Rd();this.D.F=c;this.getHandler().Sf(this.C,Oo,this.TXa).listen(this.C,"mousedown",this.SXa).Nc(this.D,"pivot_inserted",this.bZb);t8e(this.R,
this.C);a()};m.bZb=ba();m.px=function(a){kW.prototype.px.call(this,a);if(this.L&&this.tb()){this.L.setVisible(!a);var b=this.oa().Fa("waffle-assistant-button-separator",W6e(this));P(b,!a)}this.F&&w8e(this.F,this.Rd());this.D&&(a=this.Rd(),this.D.F=a)};m.oD=function(){zx(this.La(),"Suggested pivot table-"+bh(this.H,3))};m.cE=ea("assistantPivotTableFeedback");m.QH=ea(2632);m.OH=ea(2631);
function XXf(a,b){Xg(a.H,5)&&z(y(),"fewt")&&Zpa(C(a.H,5),1);var c=new z8e(null,C(a.H,5),function(){a.dispatchEvent("close-sidebar");a.Ja.C(b,a.Ba)});mJ.dispatchEvent(c)}m.TXa=function(){var a=this;this.Ja.C(35620,this.Ba);this.F=new v8e(this.R,bh(this.H,3),function(){XXf(a,35621)},function(){a.SXa()},this.oa());this.F.render();this.qa(this.F);w8e(this.F,this.Rd())};m.SXa=function(){this.C&&this.C.focus()};m.oT=function(){kW.prototype.oT.call(this);y8e(this.va,to(this.Ra))};
m.NN=function(){kW.prototype.NN.call(this);vW(this.va)};function YXf(a,b,c,d,e,f,h,k,l){d_.call(this,1,f,e,l);this.H=d;this.Ba=b;this.Ea=c;this.F=h;this.Ja=k;this.J=fz(bz(new az,10));a=new YN(a,!0,!0);this.O=new g8e(a);this.D=null}r(YXf,d_);m=YXf.prototype;m.getTitle=ea("Pivot table");m.v2=function(a){return 1==a};
m.FW=function(a){var b=C(a,1);switch(b){case 1:return new WXf(this.D,this.Ba,this.Ea,this.H,this.R,this.F,this.O,this.J,a,this.Ja,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.pT=function(a,b){C(a[0],5)&&(this.D=b?b:null,d_.prototype.pT.call(this,a,b))};m.O7=ea(5);function ZXf(){var a=null,b=new xq(function(){null!==a&&bq(a)});a=aq(function(){b.callback()});return b}function $Xf(a,b,c){Uo.call(this);this.C=fqc(sM.getInstance(),a,b,c);this.D=Cq()}r($Xf,Uo);
$Xf.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!id(c,function(f){return gCa(f,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].Qi()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&X_e(this.C),this.D=ZXf(),this.D.addCallback(function(){return x0e(d.C,b,!0)}))};
function aYf(a,b){a=a.t8b;var c='<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+R(bA({content:"INSERT CHART",style:4,hd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b));c+=R(bA({hd:"waffle-autovis-lightbox-close",content:hx(""+R(CB({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:"Close"},b));c+='</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">';
var d='aria-label="'+jx("Previous chart");d+='"';c+=R(bA({content:hx("&#10094;"),style:4,hd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:ix(d)},b));c+='<div class="goog-inline-block waffle-autovis-lightbox-container"></div>';d='aria-label="'+jx("Next chart");d+='"';c+=R(bA({content:hx("&#10095;"),style:4,hd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:ix(d)},b));c+='</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
R(a)+"</div></div></div>";return T(c)}function bYf(){return T('<div class="waffle-autovis-lightbox-chart"></div>')}function cYf(a,b,c,d,e){Q.call(this,e);this.F=a;this.D=b;this.V=c;this.R=d;this.H=[];this.C=new cA("",this.oa());this.Ga(this.C);this.O=new cA("",this.oa());this.Ga(this.O);this.L=new cA("",this.oa());this.Ga(this.L);this.J=new cA("",this.oa());this.Ga(this.J)}r(cYf,Q);m=cYf.prototype;m.Ca=function(){Q.prototype.Ca.call(this);this.pb(ny(aYf,{t8b:this.F.length}))};
m.Ia=function(){Q.prototype.Ia.call(this);var a=zub.isEnabled();dYf(this,!a);a=this.Fa("waffle-autovis-lightbox-close");this.C.Wa(a);a=this.Fa("waffle-autovis-lightbox-insert");this.O.Wa(a);var b=this.Fa("waffle-autovis-lightbox-previous");this.L.Wa(b);b=this.Fa("waffle-autovis-lightbox-next");this.J.Wa(b);eYf(this);fYf(this,this.D,!1);this.getHandler().listen(document.body,"focusin",this.oZb).listen(this.La(),"keydown",this.pZb).listen(ip(),"resize",this.sZb).listen(this.C,"action",this.close).listen(this.O,
"action",this.qBb).listen(this.L,"action",this.rZb).listen(this.J,"action",this.qZb);b=new JB(this.La(),this.oa());KB(b);this.qa(b);a.focus()};function eYf(a){var b=a.Fa("waffle-autovis-lightbox-content"),c=a.Fa("waffle-autovis-lightbox-content-inner");a=a.Fa("waffle-autovis-lightbox-page-count");var d=hp();a=Hw(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Ew(c,d,e);Ew(b,d,e+a.height+35)}function dYf(a,b){Hx(a.La(),"waffle-autovis-lightbox-readonly",b)}
function fYf(a,b,c){c&&oJ("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?gYf(a,b):a.F[b]&&(z(y(),"fecpmr")?(c=a.F[b].createChartModel(),hYf(a,c,b)):XWf(a.F[b],function(d){if(!a.isDisposed()&&d){var e=d.Te();e=e?e.toJSON():null;var f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);hYf(a,f,b)}},!0))}function hYf(a,b,c){var d=a.Fa("waffle-autovis-lightbox-container"),e=ny(bYf);d.appendChild(e);a.H[c]=e;B9e(b,e,a.V,a.R);gYf(a,c)}
function gYf(a,b){P(a.H[a.D],!1);P(a.H[b],!0);a.L.Pa(0!=b);a.J.Pa(b!=a.F.length-1);var c=a.Fa("waffle-autovis-lightbox-page-number");Cp(c,b+1);a.D=b}m.oZb=function(a){!Ap(this.La(),a.target)&&a.relatedTarget&&a.relatedTarget.focus()};m.pZb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&fYf(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||iYf(this);a.stopPropagation()};
m.sZb=function(){var a=this.Fa("waffle-autovis-lightbox-container");rp(a);this.H=[];eYf(this);fYf(this,this.D,!0)};m.qBb=function(){this.close();$Wf(this.F[this.D],2256)};m.rZb=function(){0!=this.D&&fYf(this,this.D-1,!0);0==this.D&&this.J.La().focus()};m.qZb=function(){iYf(this);this.D==this.F.length-1&&this.L.La().focus()};function iYf(a){a.D!=a.F.length-1&&fYf(a,a.D+1,!0)}m.close=function(){this.dispose()};m.zd=function(){Q.prototype.zd.call(this);var a=this.F[this.D];a&&a.La()&&a.La().focus()};
function jYf(a){var b=a.name;a='<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+U(a.title)+'">'+R(b)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="';a+=jx("Press Enter to insert formula");return T(a+'"></span></div>')}function kYf(a,b){Q.call(this);this.C=a;this.D=b}r(kYf,Q);m=kYf.prototype;m.Ca=function(){var a=ny(jYf,{name:this.C,title:this.D});this.pb(a)};
m.Ia=function(){Q.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-quicksum-entry-name");hW(a);this.getHandler().listen(this.La(),"keypress",this.tYb);P(this.La(),!1)};m.getFunctionName=g("C");m.setValue=function(a){Cp(this.Fa("waffle-assistant-quicksum-entry-value"),a||"");P(this.La(),!!a)};m.isVisible=function(){return Kw(this.La())};m.tYb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new Go("insert",this)))};
function lYf(a,b,c,d,e){Q.call(this,e);this.Ja=a;this.Ea=b;this.L=c;this.O=d;this.D=a.C;this.ma=fz(bz(new az,17));this.V=fz(bz(new az,2));this.R=!1;this.F=[];this.C=this.J=null;this.H=[]}r(lYf,Q);
lYf.prototype.Ia=function(){Q.prototype.Ia.call(this);this.Kf(new kYf(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Kf(new kYf(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Kf(new kYf(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Kf(new kYf(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Kf(new kYf(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=
new e8e(this.La(),this.Ea,this.D,this.L);this.C.F=this.R;this.qa(this.C);this.getHandler().listen(this,"insert",this.va).listen(this.C,"formula_inserted",this.Ba)};
lYf.prototype.refresh=function(a){function b(l){return h&&null!=l?ritz_api.RitzModelApi.renderNumberAsFormattedString(l,k):null}if(gI(this.D)){if(null==a){var c=jI(this.D),d=MI(c);a=dI(this.D);if(!hd(d,c.Fr,c)){P(this.La(),!1);return}c=[];for(var e=0;e<d.length;e++){var f=d[e];f=HRb(a,f.kc(),f.Qb(),f.Sc(),f.Wc());c.push(f)}a=c}d=[];this.F=[];for(c=0;c<a.length;c++)e=a[c],this.F.push(hG(e)),d.push(e.sb());a=a[0].gb();this.J=null;a!=dI(this.D)&&(this.J=(a=XH(this.D,a))?a.re():null);if(d=ritz_api.RitzModelApi.quickSum(d)){P(this.La(),
!0);a=d.count;c=d.countNumberFormat;var h=1<d.numericCount,k=h?d.valueNumberFormat:null;this.Bc(0).setValue(b(d.sum));this.Bc(1).setValue(b(d.average));this.Bc(2).setValue(b(d.min));this.Bc(3).setValue(b(d.max));1<a?this.Bc(4).setValue(ritz_api.RitzModelApi.renderNumberAsFormattedString(a,c)):P(this.La(),!1);if(this.C){this.C.R=[];this.H=[];for(d=0;d<this.tc();++d)a=this.Bc(d),this.H.push(mYf(this,a.getFunctionName()));f8e(this.C,this.H)}}else P(this.La(),!1)}else P(this.La(),!1)};
lYf.prototype.va=function(a){var b=a.target;a=this.F[0];a=new Vm(a.left,a.Sc());b=b.getFunctionName();b=mYf(this,b);a=new mud(jI(this.D),tn(a),b);this.L.C(a);this.O.C(2624,this.V)};lYf.prototype.Ba=function(){this.O.C(2624,this.ma)};function mYf(a,b){var c=a.Ja.L.D,d=a.J;a=cd(a.F,function(e){return cM(e,d)});return"="+b+"("+a.join(c)+")"}
function f_(a,b,c,d,e,f,h){xW.call(this,h);this.Va=a;this.wb=b.C;this.Xe=rM(b);this.Ba=c;this.qd=d;this.J=f;this.Zd=e;this.Na=new lYf(b,c,d,f,this.oa());this.Ga(this.Na);this.L=null;this.rb=this.Pb=!1;this.jb=!0;this.Id=dl();this.Bb=this.fb=this.bb=null;this.Ja=fz(bz(new az,10))}r(f_,xW);m=f_.prototype;m.Ca=function(){xW.prototype.Ca.call(this);this.pb(ny(nYf,{QU:this.Xe}))};
m.Ia=function(){xW.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-quicksum-panel");this.Na.Wa(a);a=this.Fa("waffle-assistant-spinner-container");this.Be.render(a);a=this.Be;a.C="#4285f4";a.tb()&&Q6e(a);a=this.Va.C;this.getHandler().listen(this,"close-sidebar",this.Nva).listen(a,"recommender-load-started",this.wva).listen(a,"recommender-load-ended",this.vva).listen(a,"recommender-calc-started",this.Rua).listen(a,"recommender-calc-ended",this.Qua).listen(this.Fa("waffle-assistant-scroll-pane"),
"scroll",U0e(this.Gia,10,this));a=zub.isEnabled();this.Fia(!a)};m.resize=function(){var a=this.Fa("waffle-assistant-sidepane-content");a=Hw(a).height;var b=this.Fa("waffle-assistant-spinner-container");nw(b,"margin-top",a/2-16+"px");this.Gia()};m.RXa=ba();function oYf(a,b){var c=pYf(a);0!=c.length&&(Tf(a.L),c=c.filter(function(d){return d instanceof VWf}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.L=new cYf(c,b,a.Zd,a.J,a.oa()),a.L.render(),a.qa(a.L),dYf(a.L,a.rb)))}
m.Fia=function(a){this.rb=a;Hx(this.La(),"waffle-assistant-readonly",a);var b=this.Na;b.R=a;b.C&&(b.C.F=a);Hx(b.La(),"waffle-assistant-quicksum-panel-readonly",a);this.L&&!this.L.isDisposed()&&dYf(this.L,a)};
m.setVisible=function(a){var b=this.isVisible();xW.prototype.setVisible.call(this,a);if(a&&!b){var c=d0e(this.Va.C,a);c?(b=new f$d,L(b,1,Fn(c,"r")),L(b,2,Fn(c,"c")),L(b,3,c.Qi()),c=new Dk,Yj(c,4,b),b=fz(ez(gz(this.Ja),c))):b=this.Ja;this.fb=fl(this.Id,"sett",!1,b);this.Be.setActive(!0);qYf(this)}a||rYf(this,!0)};m.wva=function(){this.isVisible()&&(rYf(this,!0),this.Be.setActive(!0))};m.vva=function(){this.isVisible()&&this.Be.setActive(!1)};
m.Rua=function(a){this.isVisible()&&(this.J.C(2775,this.Ja),rYf(this,void 0,a.C,a.D),sYf(this)||this.Be.setActive(!0),qYf(this),this.jb=!1)};
m.Qua=function(a){if(this.isVisible()){this.J.C(2776,this.Ja);var b=a.C;0<b.length&&(this.bb=fl(this.Id,"serr"));rYf(this,!1);this.Be.setActive(!1);a=a.D;var c=kV(this.Va.C),d=this.V.C.getActiveGrid();c=!!c&&!!d&&c.gb()!=d.gb();d=ia(this.D);for(var e=d.next();!e.done;e=d.next()){e=e.value;for(var f=[],h=ia(b),k=h.next();!k.done;k=h.next()){k=k.value;var l=bh(k,1),n;if(!(n=!e.v2(l))&&(n=c)){a:switch(l){case 2:case 4:case 6:l=!1;break a;default:l=!0}n=!l}n||f.push(k)}0<f.length?e.pT(f,a):e.qT(!0)}b=
ia(b);for(a=b.next();!a.done;a=b.next())if(a=a.value,5==bh(a,1)){this.qba();this.Ea=C(a,12);this.H=(c=yV(a))?QWe(ro(c)):null;this.va=C(a,11);tYf(this);a=this.H;c=!1;for(d=this.Qa.length-1;0<=d;d--)e=this.Qa[d],f=a,Vn(e,1)&&e.gb()==f.gb()&&qWf(dG(e),dG(f))&&qWf(eG(e),eG(f))&&(c=!0,this.Qa.splice(d,1));this.Qa.push(a);a=c;2!=this.Ea||a||uYf(this,!0)}b=pYf(this);0<b.length&&this.Pb&&(b[b.length-1].$d=!0);this.Pb=!1;qYf(this);vYf(this);this.Gia()}};
function qYf(a){var b=sYf(a),c=Kw(a.Fa("waffle-assistant-quicksum-panel")),d=a.Be.Gb();b=b||c||d;c=a.Fa("waffle-assistant-empty-list");P(c,!b);P(a.Be.La(),b)}m.Qc=ba();m.ZBa=ba();m.Rd=g("rb");m.Nva=ba();m.ESb=function(){this.bb&&(this.bb.complete(),this.bb=null);this.fb&&(this.fb.complete(),this.fb=null);this.Bb=Oa();this.jb||(this.J.C(2777,this.Ja),this.jb=!0)};
function wYf(){return T('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+R(fsc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+R("Explore")+"</div></div>")}
function nYf(a,b){a=a||{};var c=T,d=hx('<div class="waffle-assistant-replaceable-title">'+wYf(null,b)+"</div>");var e=e=a||{};e=e.QU;var f='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+R(fsc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">';f+='Get insights instantly</div><div class="waffle-assistant-empty-list-body">';f=(e?f+"To see answers, formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.")+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more';f+='</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">';f+="Give it a try";f+="</a></div></div></div>";e=T(f);e=T('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
(e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(R(TW(ex({title:d,Gl:hx(""+e),id:"autovis",Cx:"waffle-assistant-sidepanel",Qla:"waffle-assistant-title",DW:"waffle-assistant-sidepane-content"},a),b)))}
function xYf(a,b,c,d,e,f,h,k,l,n){e_.call(this,a,$Cb,d,e,f);var q=this;this.Na=n;this.bb=b;this.Ja=d;this.ob=e;this.rb=f;a=hG(d);this.J=cM(a);this.O=d.gb();this.Ra=new OXf(b,c);this.qa(this.Ra);this.H=this.F=null;this.va=h;this.V=OB(new NB);this.qa(this.V);this.Ea=new jz("",new YQ,this.oa());this.Ga(this.Ea);Yz(this.V,this.Ea,bDb);this.Ba=new jz("",new YQ,this.oa());this.Ga(this.Ba);Yz(this.V,this.Ba,$Cb);b=this.R.C.C.re();this.ma=new HW(this.bb,function(t,w,x){yYf(q,t,w,x)},!1,"e.g. A2:D5",!0,b,
this.oa());this.Ga(this.ma);this.Qa=null;this.Sa=new Uz(this);this.qa(this.Sa);this.fb=k;this.jb=l}r(xYf,e_);m=xYf.prototype;m.Ca=function(){this.pb(ny(RXf))};
m.Ia=function(){e_.prototype.Ia.call(this);this.Ea.Wa(this.Fa("waffle-tables-popup-done"));this.Ba.Wa(this.Fa("waffle-tables-popup-cancel"));this.ma.render(this.Fa("waffle-assistant-tables-data-range-wrapper"));var a=this.Fa("waffle-range-selection-input");wx(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().listen(a,"keydown",this.fZb).listen(a,"keyup",this.gZb).listen(a,"focusout",this.iMb).listen(this.R.C,"za",this.iZb).listen(this.ma,"change",this.hZb);this.Sa.subscribe(bDb,
"action",this.jZb).subscribe($Cb,"action",this.Ssb);zYf(this);a=this.Fa("waffle-tables-popup");Hx(a,"waffle-tables-popup-answers-enabled",this.jb);var b=new JB(a,this.oa());this.qa(b);KB(b);a.focus()};m.Ka=function(){Tf(this.Qa);e_.prototype.Ka.call(this)};function yYf(a,b,c,d){LV(a.fb,null,b,c,d,!1,void 0,function(e){a.Qa=e})}
m.iZb=function(){for(var a=this.R.C,b=!0,c=ia(d_b(a)),d=c.next();!d.done;d=c.next())if((d=d.value)&&d.gb()==this.O){b=!1;break}b&&"number"===typeof cI(a)&&(this.O=cI(a),AYf(this,this.O));BYf(this)};function CYf(a){var b=a.Fa("waffle-assistant-table-canvas"),c=a.Fa("waffle-assistant-canvas-container");PXf(a.Ra,b,c,a.C,a.D,a.L)}m.Ssb=function(){this.dispatchEvent("ie")};
m.jZb=function(){var a=!Qnc.test(this.J);P(this.cb("waffle-assistant-tables-range-error"),a);Hx(this.Fa("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.ob!=this.L||this.rb!=this.D;var b=!this.Ja.equals(this.C),c=this.Ja.gb()!=this.C.gb();if(a||b)a&&this.va.C(35506),b&&this.va.C(35507),c&&this.va.C(35723),this.dispatchEvent(new NXf(gG(this.C),this.L,this.D,c));this.dispatchEvent("ie")}};
function zYf(a){var b=a.Fa("waffle-range-selection-input"),c=hG(a.Ja);a.J=cM(c);b.value=a.J;BYf(a);DYf(a);CYf(a)}m.Hia=function(a,b,c){e_.prototype.Hia.call(this,a,b,c);CYf(this)};
function EYf(a){var b=kI(a.R.C,a.O),c=b.Kb(),d=Tnc(a.J,b),e=null!=d;if(e&&(b=n1b(b,d),e=Hn(b))){b=fG(b,c);var f=dG(b);c=eG(b);b=b.gb();d=no(f);f=Vn(f,2)?Yn(f,2):ritz_api.RitzModelApi.getNumberOfRows(b);var h=no(c);c=Vn(c,2)?Yn(c,2):ritz_api.RitzModelApi.getNumberOfColumns(b);c=HRb(b,d,h,f,c);a.Hia(c,FYf(a,c),a.D);BYf(a);DYf(a)}P(a.cb("waffle-assistant-tables-range-error"),!e)}function FYf(a,b){b=GYf(b,a.D);return a.L>b?b:a.L}
function GYf(a,b){a=0==b?a.Sc()-a.kc():a.Wc()-a.Qb();return 0==a?3:Math.min(a-1,3)}
function BYf(a){if(a.Na){P(Ip(a.oa(),"waffle-assistant-tables-data-range-label"),!1);Tf(a.H);var b=z(y(),"feuuc")?xG.getInstance():PAe.getInstance();a.H=new aW(void 0,b);a.H.setContent("Data range");a.Ga(a.H);Yz(a.V,a.H,cDb);a.H.render(a.Fa("waffle-assistant-tables-edit-sheet-button"));a.getHandler().listen(a.H,"action",a.oKb);b=0;for(var c=ia(d_b(a.R.C)),d=c.next();!d.done;d=c.next())if(d=d.value)d.gb()===a.O&&(b=a.H.Qh()),a.H.Vc(new nz(d.re(),d.gb()));a.H.If(b)}}
function DYf(a){Tf(a.F);a.F=new aW(void 0,xG.getInstance());a.Ga(a.F);Yz(a.V,a.F,aDb);a.F.render(a.Fa("waffle-assistant-tables-edit-headers-button"));a.getHandler().listen(a.F,"action",a.gAb);for(var b=GYf(a.C,0),c=0;c<=b;c++){var d=(new VA("{NUM_HEADER_RECORDS,plural, =0{No rows}=1{1 row}other{# rows}}")).format({NUM_HEADER_RECORDS:c});a.F.Vc(new nz(d))}c=GYf(a.C,1);for(d=0;d<=c;d++){var e=(new VA("{NUM_HEADER_RECORDS,plural, =0{No columns}=1{1 column}other{# columns}}")).format({NUM_HEADER_RECORDS:d});
a.F.Vc(new nz(e))}c=a.L;a.F.If(0==a.D?c:c+b+1);a.F.setContent("Headers")}m.iMb=function(){var a=this.Fa("waffle-range-selection-input");this.J!=a.value&&(this.J=a.value,EYf(this))};m.hZb=function(){var a=this.ma.getValue();this.J=a;var b=this.Fa("waffle-range-selection-input");b.value=a;b.select();EYf(this)};m.oKb=function(){var a=this.H.getValue();a!=this.O&&(this.O=a,AYf(this,this.O));EYf(this)};
function AYf(a,b){if(a.Na){var c=kI(a.R.C,b),d=wn(MI(c));ritz_api.TablesApi.getTables(fG(d,b).sb(),function(e){if(e.length){var f=e[0];e=f.getDimensionTableAccessor().getHeaderRange();var h=hG(mo(ritz_api.RitzModelApi.toSerializedGridRangeProto(e)));e=f.getDimensionTableAccessor().getDimensionTagName();h=Fn(h,0==e?"r":"c");f=hG(mo(ritz_api.TablesApi.getTableGridRange(f)))}else f=d,e=h=0;a.D=e;a.L=h;e=cM(f);a.J=e;e=a.Fa("waffle-range-selection-input");e.value=a.J;e.select();EYf(a)})}}
m.fZb=function(a){var b=this.Fa("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.J=b.value;EYf(this);bDb.qb();break;case 27:a.stopPropagation(),a.preventDefault(),zYf(this),$Cb.qb()}};m.gZb=function(){this.J=this.Fa("waffle-range-selection-input").value;EYf(this)};m.gAb=function(){var a=this.F.ji(),b=GYf(this.C,0);this.Hia(this.C,a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};
function HYf(a,b,c,d,e,f,h,k,l,n,q,t){f_.call(this,a,b,c,e,d,f,t);this.Ad=n;this.Rc=h;this.V=b;this.Xa=new Q(this.oa());this.Ga(this.Xa);this.R=new D8e(q);this.qa(this.R);this.D=[];this.F=null;this.Ra=new cA("",t,4);Ry(this.Ra,2,!1);this.Ga(this.Ra);this.$c=k;this.Oc=l;this.H=null;this.Ea=0;this.va=null;this.ob=new jz("",new YQ,this.oa());this.Ga(this.ob);this.Hb=new Q(this.oa());this.Ga(this.Hb);this.Cc=OB(new NB);this.qa(this.Cc);Yz(this.Cc,this.ob,dDb);this.ma=this.O=null;this.Qa=[]}r(HYf,f_);
m=HYf.prototype;
m.Ia=function(){var a=this;f_.prototype.Ia.call(this);this.Xa.Wa(this.Fa("waffle-assistant-expanded-panel"));hW(this.C.La(),"Close");this.Hb.Wa(this.Fa("waffle-assistant-sidepane-tables-range"));tYf(this);this.ob.Wa(this.Fa("waffle-assistant-tables-edit-range-button"));if(rM(this.V)){var b=new sXf(this.Rc,this.Ba,this.wb,this.qd,this.J,this.R,this.V,this.Oc,this.Ad,this.oa());this.Ga(b);this.D.push(b)}b=new MXf(this.J,this.R,this.oa());this.Ga(b);this.D.push(b);z(y(),"feedvs")&&(b=new CXf(this.J,
this.R,this.Ba,this.oa()),this.Ga(b),this.D.push(b));b=new YXf(this.Rc,this.wb,this.V,this.qd,this.J,this.R,this.Ba,this.Ad,this.oa());this.Ga(b);this.D.push(b);b=new qXf(this.wb,this.Ba,this.Zd,this.J,this.R,this.oa());this.Ga(b);this.D.push(b);var c=this.Fa("waffle-assistant-features");$c(this.D,function(d){d.render(c);a.Xa.Ga(d.C,!0)});this.Ra.Wa(this.Fa("waffle-assistant-empty-list-learn-more"));this.getHandler().listen(this.Ra,"action",this.TYb).listen(this,"ie",this.qba).listen(this,"he",this.UYb);
IYf(this)};m.UYb=function(){var a=JYf(this);a&&(a.Ra=!0)};m.TYb=function(){(Mt(),Dv).qb(RAe)};function vYf(a){$c(a.D,function(b){lXf(b)})}function rYf(a,b,c,d){$c(a.D,function(e){e.qT(b,c,d)})}function sYf(a){return!!id(a.D,function(b){return b.Zva()})}m.Gia=function(){var a=this,b=this.Fa("waffle-assistant-scroll-pane").scrollTop+Hw(this.Fa("waffle-assistant-sidepane-content")).height;$c(this.D,function(c){a.F&&a.F!=c||(c instanceof qXf&&a.getHandler().Nc(c,"ce",a.ESb),b=c.P7(b))})};
function pYf(a){if(a.F)return a.F.C.C;var b=[];$c(a.D,function(c){ud(b,kXf(c))});return b}m.Fia=function(a){f_.prototype.Fia.call(this,a);IYf(this)};m.RXa=function(a){$c(this.D,function(b){b.OXa(a)})};m.ZBa=function(){var a=this.Fa("waffle-assistant-replaceable-title"),b=this.Fa("waffle-assistant-title");Gw(b,Hw(a).height)};
m.Qc=function(){var a=this,b=this.Fa("waffle-assistant-scroll-pane-feature-content"),c=this.Fa("waffle-assistant-replaceable-title"),d=this.Xa.La();if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,P(d,!1),P(b,!0),ly(c,wYf),xx(c,"label"),this.resize(),oJ("Explore opened");else if(this.F=id(this.D,function(e){return e.Gb()}))P(b,!1),P(d,!0),this.F.C.setVisible(!0),mXf(this.F,c),zx(c,this.F.getTitle()),b=this.F.getTitle()+" section expanded.",oJ(b);this.ZBa();b=new Rq(function(){var e=
oC.Uz();e&&e.dispatchEvent("resize");a.Gia()},300);this.qa(b);b.start()};m.setVisible=function(a){var b=this.isVisible();f_.prototype.setVisible.call(this,a);a&&!b&&KYf(this,!0);a||this.R.clear()};m.Nva=function(){f_.prototype.Nva.call(this);this.F&&this.Qc();this.qba()};m.wva=function(){f_.prototype.wva.call(this);KYf(this,!0)};m.vva=function(){f_.prototype.vva.call(this);KYf(this,!1)};m.Rua=function(a){f_.prototype.Rua.call(this,a);KYf(this,!0,a.C)};
m.Qua=function(a){f_.prototype.Qua.call(this,a);KYf(this,!1)};function LYf(a,b){var c=JYf(a);if(b){var d=z(y(),"feenas");a.O=new xYf(a.V,a.Ba,a.$c,a.H,a.Ea,a.va,a.J,a.Oc,null!=c&&c.Gb(),d);a.Ga(a.O);a.O.render(a.getElement())}else a.O&&(a.removeChild(a.O,!0),Tf(a.O),a.O=null);c&&vXf(c,b)}function uYf(a,b){if(1!=a.va){var c=JYf(a);b?(a.ma=new VXf(a.V,a.Ba,a.$c,a.H,a.Ea,a.va,null!=c&&c.Gb()),a.Ga(a.ma),a.ma.render(a.getElement())):a.ma&&(a.removeChild(a.ma,!0),Tf(a.ma),a.ma=null);c&&vXf(c,b)}}
function IYf(a){$c(a.D,function(b){b.rT(a.Rd())})}function JYf(a){return(a=id(a.D,function(b){return b instanceof sXf}))&&a}function KYf(a,b,c){$c(a.D,function(d){d.uo(b,c)});b&&(a.H=null,a.Ea=0,a.va=null,a.qba(),tYf(a))}
function tYf(a){var b=a.Fa("waffle-sidebar-tables-bar"),c=a.Fa("waffle-assistant-scroll-pane");var d=null;var e=z(y(),"feenas"),f=kV(a.Va.C);if(a.H||e&&f){if(a.H){var h=hG(a.H);f=a.H.gb();e&&(d=XH(a.V.C,f).re())}else h=f.Fc().C,d=f.re(),a.H=fG(h,f.gb()),a.va=0;d=cM(h,d);d=ny(TXf,{hD:d});a=a.Hb.ub();rp(a);a.appendChild(d);P(b,!0);Dx(c,"waffle-assistant-tables-scroll-pane")}else P(b,!1),Fx(c,"waffle-assistant-tables-scroll-pane")}m.qba=function(){LYf(this,!1);uYf(this,!1)};
function MYf(){var a='<div style="float:right;"><div class="'+U("waffle-inline-assistant-ignore-button")+'">';return T(a+"Ignore</div></div>")}function NYf(a){var b='<div class="'+U("waffle-assistant-input-reject-icon")+'" style="display:none" aria-label="';b+=jx("Reject suggestion");b+='">'+R(CB({icon:"docs-icon-img docs-icon-close"},a))+"</div>";return T(b)}
function OYf(a,b){var c=a.column,d=a.Hcc,e=a.Gcc,f=a.eRb;a=a.IOb;var h='<div style="outline: none;margin-bottom: 12px;">';f?(h+='<div class="'+U("waffle-inline-assistant-nf-suggestion-description")+'">',h+="Numbers in this column are text</div>"):a&&(h+='<div class="'+U("waffle-inline-assistant-nf-suggestion-description")+'">',h+="There are multiple formats in this column</div>");h+='<div class="'+U("waffle-inline-assistant-recommendation-container")+'"><div class="'+U("waffle-inline-assistant-gridrange-chip")+
'">'+R(c)+NYf(b)+'</div><div class="'+U("waffle-inline-assistant-suggestion-row")+'">';if(f)h+='<div class="'+U("waffle-inline-assistant-nf-row")+'"><div class="'+U("waffle-inline-assistant-nf-suggested-preview")+" "+U("waffle-inline-assistant-nf-suggestion-text")+'">',h+="Convert to numbers</div></div>";else for(c=Math.max(0,Math.ceil(d.length)),f=0;f<c;f++){var k=f;h+='<div class="'+U("waffle-inline-assistant-nf-row")+'">'+(a?"":'<div class="'+U("waffle-inline-assistant-nf-original-preview")+" "+
U("waffle-inline-assistant-nf-suggestion-text")+'">'+R(d[k])+"</div>")+'<div class="'+U("waffle-inline-assistant-nf-suggested-preview")+" "+U("waffle-inline-assistant-nf-suggestion-text")+'">'+R(e[k])+"</div></div>"}h+='</div><div class="'+U("waffle-assistant-card-feedback")+" "+U("waffle-assistant-in-cell-card-feedback")+'"></div><div class="'+U("waffle-inline-assistant-nf-check")+'">'+R(CB({icon:"docs-icon-img docs-icon-check"},b))+"</div></div></div>";return T(h)}
function PYf(a){var b=a.Eg;a=a.CIa;b='<div style="outline: none"><div class="'+U("waffle-inline-assistant-recommendation-container")+'"><div class="'+U("waffle-inline-assistant-gridrange-chip")+'">'+R(b)+'</div><div class="'+U("waffle-inline-assistant-suggestion-row")+'"><div class="'+U("waffle-inline-assistant-tw-row")+'">';for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=fx(e,null)?'<div class="'+U("waffle-inline-assistant-tw-space")+'"></div>':R(e)}return T(b+"</div></div></div></div>")}
function QYf(a,b){a=a.gAa;b='<div class="'+U("waffle-inline-assistant-suggestion-row-overflow-button docs-material")+'">'+R(CB({icon:"docs-icon-img docs-icon-chevron-down-24"},b));a="See "+(R(a)+" more");return T(b+a+"</div>")}
function RYf(a,b){var c=a.lU;a=a.qdb;for(var d='<div style="outline: none; overflow:hidden;">',e=Math.max(0,Math.ceil(Math.min(3,c.length))),f=0;f<e;f++){var h=f;d+=PYf({Eg:c[h],CIa:a[h]})}if(3<c.length){d+=QYf({gAa:c.length-3},b)+'<div class="'+U("waffle-inline-assistant-overflow-suggestions")+'" style="display:none">';b=Math.max(0,Math.ceil(c.length-3));for(e=0;e<b;e++)f=3+e,d+=PYf({Eg:c[f],CIa:a[f]});d+="</div>"}d+='<div style="float:right"><div class="'+U("waffle-inline-assistant-accept-button")+
'">';d=d+"Trim all whitespace</div></div>"+(MYf()+'<div style="float:right"><div class="'+U("waffle-assistant-card-feedback")+'"></div></div></div>');return T(d)}function SYf(){var a='<div class="'+U("waffle-inline-assistant-sidebar-toast")+'"><div class="'+U("waffle-inline-assistant-toast-undo-button")+'">';a=a+'Undo</div><div class="'+(U("waffle-inline-assistant-toast-text")+'"></div></div>');return T(a)}
function TYf(a){a=a.m8b;a=mT(new VA("{NUM_CELLS_CHANGED_1,plural, =1{Change applied to {NUM_CELLS_CHANGED_2} cell}other{Change applied to {NUM_CELLS_CHANGED_2} cells}}"),{NUM_CELLS_CHANGED_1:a,NUM_CELLS_CHANGED_2:R(a)});return T(a)}function UYf(a){a="Column "+(R(a.eeb)+" format applied");return T(a)}
function VYf(a){a=a.p8b;a=mT(new VA("{NUM_ROWS_REMOVED_1,plural, =1{{NUM_ROWS_REMOVED_2} row removed}other{{NUM_ROWS_REMOVED_2} rows removed}}"),{NUM_ROWS_REMOVED_1:a,NUM_ROWS_REMOVED_2:R(a)});return T(a)}
function WYf(a,b){a='<div class="waffle-inline-assistant-sidebar-insights-cta-container"><div class="waffle-inline-assistant-sidebar-divider"></div><div class="waffle-inline-assistant-sidebar-insights-header">Get more insights about your data</div>'+R(bA({hd:"waffle-inline-assistant-sidebar-insights-cta",content:"Review column stats",style:2},b));return T(a+"</div>")}
function XYf(a){var b=a.fCa,c=a.X3;a=a.Rq;b='<div style="outline: none"><div class="'+U("waffle-inline-assistant-recommendation-container")+'">'+(a?'<div class="'+U("waffle-inline-assistant-rd-deleted-strikethrough")+'"></div><div class="'+U("waffle-inline-assistant-gridrange-chip")+'">'+R(b+1)+"</div>":'<div class="'+U("waffle-inline-assistant-gridrange-chip")+" "+U("waffle-inline-assistant-gridrange-chip-neutral")+'">'+R(b+1)+"</div>")+'<div class="'+U("waffle-inline-assistant-suggestion-row")+
'"><div class="'+U("waffle-inline-assistant-rd-cell-preview")+'">';a=c.length;for(var d=0;d<a;d++)b+=R(c[d])+'<div class="'+U("waffle-inline-assistant-rd-cell-value-divider")+'"></div>';return T(b+"</div></div></div></div>")}
function YYf(a,b){var c=a.wec;a=a.X3;for(var d='<div tabindex=0 role="region" style="overflow:hidden; outline:none">'+XYf({fCa:c[0],X3:a,Rq:!1}),e=Math.max(0,Math.ceil(Math.min(3,c.length)-1)),f=0;f<e;f++)d+=XYf({fCa:c[1+f],X3:a,Rq:!0});if(3<c.length){d+=QYf({gAa:c.length-3},b)+'<div class="'+U("waffle-inline-assistant-overflow-suggestions")+'" style="display:none">';b=Math.max(0,Math.ceil(c.length-3));for(e=0;e<b;e++)d+=XYf({fCa:c[3+e],X3:a,Rq:!0});d+="</div>"}d+='<div style="float:right"><div class="'+
U("waffle-inline-assistant-accept-button")+'">';d=d+"Remove</div></div>"+(MYf()+'<div style="float:right; position: relative;"><div class="'+U("waffle-assistant-card-feedback")+'"></div></div></div>');return T(d)}function ZYf(a){a=a.uja;a=mT(new VA("{NUM_OVERFLOW_CARDS_1,plural, =1{Show {NUM_OVERFLOW_CARDS_2} more suggestion}other{Show {NUM_OVERFLOW_CARDS_2} more suggestions}}"),{NUM_OVERFLOW_CARDS_1:a,NUM_OVERFLOW_CARDS_2:R(a)});return T(a)}
function $Yf(a,b){var c=a.odb;a=a.uja;return T('<div class="'+U("waffle-inline-assistant-sidebar-category-container")+'"><div class="'+U("waffle-inline-assistant-sidebar-category-header")+'"><div class="'+U("waffle-inline-assistant-sidebar-category-label")+'">'+R(c)+'</div></div><div class="'+U("waffle-inline-assistant-sidebar-category-cards")+'"></div><div class="'+U("waffle-inline-assistant-sidebar-category-show-more-button docs-material")+'">'+R(CB({icon:"docs-icon-img docs-icon-chevron-down-24"},
b))+ZYf({uja:a},b)+"</div></div>")}function aZf(a){var b=a.l8b,c=a.VK;a='<div class="'+U("waffle-assistant-anomaly-description")+'">';1==b?(b='This cell is not a <span style="font-weight:bold; text-transform: lowercase;">'+(R(c)+"</span>"),a+=b):1<b&&(b='These cells are not <span style="font-weight:bold; text-transform: lowercase;">'+(R(c)+"s</span>"),a+=b);return T(a+"</div>")}
function bZf(a){var b='<div class="'+U("waffle-assistant-input-return-icon")+'" style="display:none" aria-label="';b+=jx("Finish editing");b+='">'+R(CB({icon:"docs-icon-img docs-icon-check"},a))+"</div>";return T(b)}
function cZf(a,b){var c=a.BIa;a=a.DIa;c='<div tabindex=0 role="textbox" class="'+U("waffle-assistant-card-single-anomaly")+" "+U("waffle-assistant-card-single-anomaly"+c)+'" style="outline: none;"><div class="'+U("waffle-assistant-input-container")+" "+U("waffle-assistant-input-container"+c)+'"><div class="'+U("waffle-inline-assistant-gridrange-chip")+'">'+R(c)+NYf(b)+'</div><div class="'+U("waffle-assistant-form")+'">';c+='<div class="'+U("waffle-assistant-card-feedback")+" "+U("waffle-assistant-in-cell-card-feedback")+
'"></div><div class="'+U("waffle-assistant-input-edit-icon")+'">'+R(CB({icon:"docs-icon-img docs-icon-edit-outline-20"},b))+"</div>"+bZf(b)+'<input type="text" class="'+U("jfk-textinput")+" "+U("waffle-assistant-anomaly-input")+'" placeholder="'+U("New cell value")+'" aria-label="'+U("New cell value")+'" value="'+U(a)+'"/></div></div></div>';return T(c)}
function dZf(a,b){var c=a.pdb;a=a.sdb;var d='<div tabindex=0 role="region" class="'+U("waffle-assistant-anomaly-card")+'"><div tabindex="0" role="textbox" class="'+U("waffle-anomaly-grey-out")+" "+U("waffle-assistant-card-anomaly")+'"></div><div class="'+U("waffle-anomaly-apply-all-hint")+'" style="display:none">';d+="Input for all instances";var e=a[0];e=T('<div tabindex=0 role="textbox" class="'+U("waffle-assistant-card-apply-all")+'" style="outline: none;"><div class="'+U("waffle-assistant-input-container")+
'"><div class="'+U("waffle-assistant-form")+'"><input type="text" class="'+U("jfk-textinput")+" "+U("waffle-assistant-anomaly-input")+" "+U("waffle-inline-assistant-apply-all-input-box")+'" placeholder="New value for all anomalies" aria-label="'+U(e)+'" value="'+U(e)+'"/>'+bZf(b)+"</div></div></div>");d+="</div>"+e;e=Math.max(0,Math.ceil(Math.min(3,c.length)));for(var f=0;f<e;f++){var h=f;d+=cZf({BIa:c[h],DIa:a[h]},b)}if(3<c.length){d+=QYf({gAa:c.length-3},b)+'<div class="'+U("waffle-inline-assistant-overflow-suggestions")+
'" style="display:none">';e=Math.max(0,Math.ceil(c.length-3));for(f=0;f<e;f++)h=3+f,d+=cZf({BIa:c[h],DIa:a[h]},b);d+="</div>"}d+='<div class="'+U("waffle-assistant-anomaly-apply-all-container")+'"><div class="'+U("waffle-assistant-anomaly-apply-to-all-text")+'">';d=d+'Apply to all</div><div class="'+(U("waffle-assistant-anomaly-apply-all-check")+'"></div></div></div>');return T(d)}function eZf(a,b,c,d){A.call(this);this.H=a;this.D=b;this.J=c;this.hb=d||null}r(eZf,ET);
eZf.prototype.C=function(a){var b=this,c=[],d=new nz("Suggestion is incorrect",null,this.hb);d.Mc("apps-menuitem");c.push(d);Yz(a,d,this.H,void 0,function(){return fZf(b,"Suggestion is incorrect")},this.D);d=new nz("Suggestion is not critical",null,this.hb);d.Mc("apps-menuitem");c.push(d);Yz(a,d,this.H,void 0,function(){return fZf(b,"Suggestion is not critical")},this.D);d=new nz("Other",null,this.hb);d.Mc("apps-menuitem");c.push(d);Yz(a,d,this.H,void 0,function(){return fZf(b,"Other")},this.D);c.push(null);
d=ny(Pcf);d=new nz(d,null,this.hb);d.Mc("apps-menuitem");c.push(d);Yz(a,d,this.H,void 0,function(){return fZf(b,"Other")},this.D);return c};function fZf(a,b){return new M0e({description:b},a.J,a.D)}var gZf={Moc:"anomaly",u9a:"remove-duplicates",gMc:"number-format",C$a:"trim-whitespace"};
function g_(a,b,c,d,e,f){Q.call(this,f);var h=this;this.jb=a;this.wb=b;this.D=vJ(b);this.C=c;this.fb=d;this.R=e;this.ob=new uW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.ob);this.J=new uW(b,"waffle-assistant-mouseover-highlight-styled-border","waffle-assistant-mouseover-highlight-styled-rect");this.qa(this.J);this.Sa=new uW(b,"waffle-assistant-mouseover-highlight-styled-border-red","waffle-assistant-mouseover-highlight-styled-rect-red");this.qa(this.Sa);
this.Qa=new cA;this.Ga(this.Qa);this.ma=new Wz(void 0,void 0,void 0,MB.getInstance());this.qa(this.ma);this.Bb=new Bqe(function(){return h.ma},this.oa());this.qa(this.Bb);this.Hb=fz(bz(new az,76));this.O=null;this.Na={};this.Pb=new Uz(this);this.qa(this.Pb);this.Ba=[];this.Ja=[];this.va=null}r(g_,Q);m=g_.prototype;m.J4=ea("waffle-inline-assistant-ignore-button");
function hZf(a,b){var c=new cA,d=a.Ja.length;c.Wa(a.Vf(a.J4())[d]);a.Ja.push(c);var e=b?{card:a}:{card:a,Uhc:d};Yz(a.ma,c,jub,Zz,function(){return e},iZf(a))}
m.Ia=function(){Q.prototype.Ia.call(this);var a=this.La();this.getHandler().listen(a,"mouseenter",this.g8).listen(a,"mouseleave",this.A_);jZf(this);a=this.Vf(this.J4()).length;for(var b=1===a,c=0;c<a;c++)hZf(this,b);if(a=this.cb("waffle-inline-assistant-suggestion-row-overflow-button"))this.Qa.Wa(a),this.getHandler().listen(this.Qa,"action",this.Z6b)};m.Ka=function(){Q.prototype.Ka.call(this);this.xO()};m.g8=function(){h_(this,!0);vW(this.ob);y8e(this.J,this.C);this.xO();this.K9()};
m.A_=function(){h_(this,!1);this.xO();vW(this.J);this.La().blur()};function kZf(a){null==a.va&&(a.va=qPc(a.D))}function lZf(a){a.va&&(sP(a.D,a.va.y,a.va.x),a.va=null)}function iZf(a){return fz(ez(bz(new az,76),a.kja()))}m.Z6b=function(){this.fb.C(36812,iZf(this));var a=this.Fa("waffle-inline-assistant-overflow-suggestions");P(a,!0);this.La().focus();this.Qa.Pa(!1);this.Qa.setVisible(!1)};
function jZf(a){if(z(y(),"fedpsf")&&!(0<a.Ba.length))for(var b=a.Vf("waffle-assistant-card-feedback"),c={},d=0;d<b.length;c={lG:c.lG},d++){var e=b[d];c.lG=new pdf(a.oa());a.Ga(c.lG);a.Ba.push(c.lG);var f=new eZf(oub,a.Hb,a.Na,a.oa());Dqe(a.Bb,c.lG.Ab(),[f]);c.lG.render(e);a.R||(c.lG.setVisible(!1),a.getHandler().listen(c.lG.Ab(),"afterhide",function(h){return function(){h.lG.setVisible(!1)}}(c)))}}m.isVisible=function(){return this.cb("waffle-inline-assistant-gridrange-chip")?!0:!1};
function i_(a){return a.C.map(function(b){return b.rect})}m.hta=ea(null);m.gOa=function(){return this.Vf("waffle-inline-assistant-recommendation-container")};function h_(a,b){a.R||1!==a.Ba.length||(a=a.Ba[0],b?a.setVisible(!0):b||a.Ab().isVisible()||a.setVisible(!1))}
function mZf(a,b,c,d,e,f,h,k,l){c.sort(function(n,q){return n.rect.top-q.rect.top});g_.call(this,a,b,c,h,k,l);this.Va=d;this.H=this.C.map(function(n){return cM(n.rect)});this.bb=cd(c,function(n){return n.rect.top});this.V=e;this.L=new IQ(this.oa());this.Ga(this.L);this.Ra=new Q;this.Ga(this.Ra);this.Ea=new Q;this.Ga(this.Ea);this.Xa=null;this.rb=f}r(mZf,g_);m=mZf.prototype;m.kja=function(){var a=new Dk;L(a,21,3);var b=new r$d;L(b,2,nZf(this.Va));Yj(a,26,b);b=new Ek;L(b,1,1);zXe(a,b);return a};
m.JT=ea("anomaly");m.hta=function(a,b){for(var c=b.length-1;0<=c;c--)this.V.splice(b[c],1);b=!1;this.rb&&1<a.length&&(b=!0);return new mZf(this.jb,this.wb,a,this.Va,this.V,b,this.fb,this.R)};m.gOa=function(){return this.Vf("waffle-assistant-card-single-anomaly")};m.Ca=function(){var a=ny(dZf,{pdb:this.H,sdb:this.V});this.pb(a);a={};this.Na=(a.recommendationCategory="CATEGORICAL_ANOMALY",a.recommendationRange=this.H.join(","),a)};
m.Ia=function(){var a=this;g_.prototype.Ia.call(this);for(var b=this.Vf("jfk-textinput"),c=this.Vf("waffle-assistant-card-single-anomaly"),d=this.Vf("waffle-inline-assistant-gridrange-chip"),e=this.Vf("waffle-assistant-input-edit-icon"),f=this.Vf("waffle-assistant-input-return-icon"),h={gw:0};h.gw<this.H.length;h={DP:h.DP,Pma:h.Pma,oV:h.oV,gw:h.gw,F$:h.F$,I$:h.I$,nK:h.nK},h.gw++){h.nK=b[h.gw+1];var k=f[h.gw+1];h.DP=this.H[h.gw];h.Pma=this.V[h.gw];var l=c[h.gw];h.F$=d[h.gw];var n=e[h.gw];h.oV=this.Ba[h.gw];
h.I$=this.Ja[h.gw];this.R&&h.oV.setVisible(!0);this.getHandler().listen(h.nK,["mousedown","click","mouseup","keydown"],function(q){return void q.stopPropagation()}).listen(h.nK,"input",function(q){return function(){oZf(a,q.DP,!0,null)}}(h)).listen(h.nK,"focus",function(q){return function(){var t=q.DP,w=q.Pma,x=q.oV,F=a.Fa("waffle-assistant-input-container"+t);pZf(a,t)!==w?oZf(a,t,!0,null):Dx(F,"waffle-assistant-input-container-focused");t=fp("waffle-assistant-input-edit-icon",F);P(t,!1);F=fp("waffle-inline-assistant-gridrange-chip",
F);Dx(F,"waffle-inline-assistant-gridrange-chip-hovered");a.R||x.setVisible(!1)}}(h)).listen(h.nK,"blur",function(q){return function(){return qZf(a,q.DP)}}(h)).listen(h.nK,"keydown",function(q){return function(t){return rZf(a,t,q.DP)}}(h)).listen(l,"mouseenter",function(q){return function(){var t=q.F$,w=q.oV,x=q.I$,F=a.C[q.gw];h_(a,!0);kZf(a);sP(a.D,F.rect.top,F.rect.left);a.L.isChecked()?y8e(a.J,a.C):wW(a.J,F);Dx(t,"waffle-inline-assistant-gridrange-chip-hovered");t=t.childNodes[0];a.Xa=t.nodeValue;
t.nodeValue="";x.setVisible(!0);w.setVisible(!0)}}(h)).listen(l,"mouseleave",function(q){return function(){var t=q.F$,w=q.oV,x=q.I$;h_(a,!1);vW(a.J);Fx(t,"waffle-inline-assistant-gridrange-chip-hovered");a.R||w.Ab().isVisible()||w.setVisible(!1);t.childNodes[0].nodeValue=a.Xa;a.Xa=null;x.setVisible(!1)}}(h)).listen(n,"click",function(q){return function(){var t=q.nK;t.focus();t.selectionStart=t.selectionEnd=t.value.length}}(h)).listen(k,"click",function(q){return function(){return sZf(a,q.DP)}}(h)).listen(this.L,
"change",this.Mtb)}this.Ea.Wa(this.Fa("waffle-anomaly-grey-out"));P(this.Ea.La(),!1);b=this.Fa("waffle-assistant-card-apply-all");nw(b,"height","0px");nw(b,"visibility","hidden");c=fp("waffle-assistant-input-return-icon",b);this.getHandler().listen(b,"keydown",function(q){return rZf(a,q,null)}).listen(c,"click",this.VPa).listen(b,"input",this.bQa);this.Ra.Wa(this.Fa("waffle-assistant-anomaly-apply-all-container"));this.rb||P(this.Ra.La(),!1);b=this.Fa("waffle-assistant-anomaly-apply-to-all-text");
c=this.Fa("waffle-assistant-anomaly-apply-all-check");sA(this.L,b);this.L.Wa(c);this.R&&(nw(c,"zoom","100%"),nw(b,"font-size","13px"))};
m.Mtb=function(){this.cb("waffle-assistant-card-single-anomaly");var a=this.Fa("waffle-assistant-card-apply-all"),b=this.Vf("waffle-assistant-input-edit-icon"),c=this.gOa(),d=this.Vf("waffle-assistant-input-reject-icon");if(this.L.isChecked()){P(this.Ea.La(),!0);var e=this.Fa("waffle-anomaly-apply-all-hint");P(e,!0);nw(a,"transition","height 0.2s linear");nw(a,"visibility","visible");nw(a,"z-index","1000");nw(a,"height","39px");nw(a,"margin-top","10px");a=fp("waffle-assistant-input-container",a);
e=this.Fa("waffle-inline-assistant-apply-all-input-box");e.focus();e.select();e.value!==this.V[0]?this.bQa():Dx(a,"waffle-assistant-input-container-focused");for(a=0;a<b.length;a++)P(b[a],!1),c[a].setAttribute("tabIndex","-1"),fp("jfk-textinput",c[a]).setAttribute("tabIndex","-1"),d[a].setAttribute("tabIndex","-1")}else{P(this.Ea.La(),!1);nw(a,"transition","height 0.2s linear, visibility 0s linear 0.2s");nw(a,"z-index","");nw(a,"height","0px");nw(a,"margin-top","");nw(a,"visibility","hidden");a=fp("waffle-assistant-input-container",
a);Fx(a,"waffle-assistant-input-container-focused");Fx(a,"waffle-assistant-input-container-changed");for(e=0;e<this.H.length;e++)oZf(this,this.H[e],!1,this.V[e]);e=this.Fa("waffle-anomaly-apply-all-hint");P(e,!1);Fx(e,"waffle-anomaly-apply-all-hint-changed");a=fp("waffle-assistant-input-return-icon",a);P(a,!1);for(a=0;a<b.length;a++)P(b[a],!0),qZf(this,this.H[a]),c[a].setAttribute("tabIndex","0"),fp("jfk-textinput",c[a]).setAttribute("tabIndex","0"),d[a].setAttribute("tabIndex","0")}};m.J4=ea("waffle-assistant-input-reject-icon");
m.bQa=function(){var a=this.Fa("waffle-assistant-card-apply-all"),b=fp("waffle-assistant-input-container",a);Dx(b,"waffle-assistant-input-container-changed");b=this.Fa("waffle-inline-assistant-apply-all-input-box").value;for(var c=0;c<this.H.length;c++)oZf(this,this.H[c],!1,b);b=this.Fa("waffle-anomaly-apply-all-hint");Dx(b,"waffle-anomaly-apply-all-hint-changed");a=fp("waffle-assistant-input-return-icon",a);P(a,!0)};
function oZf(a,b,c,d){a=a.Fa("waffle-assistant-input-container"+b);c?(Dx(a,"waffle-assistant-input-container-changed"),c=fp("waffle-assistant-input-return-icon",a),P(c,!0)):fp("jfk-textinput",a).value=d;c=fp("waffle-inline-assistant-gridrange-chip",a);Dx(c,"waffle-inline-assistant-gridrange-chip-changed")}function rZf(a,b,c){switch(b.keyCode){case 13:a.L.isChecked()?a.VPa():sZf(a,c)}}
m.VPa=function(){for(var a=this.Fa("waffle-inline-assistant-apply-all-input-box"),b=[],c=ia(this.C),d=c.next();!d.done;d=c.next())(d=d.value)&&(b=b.concat(d.rect));c=iZf(this);d=new Ek;L(d,1,b.length);bk(c.C,10,[d]);iub.qb({card:this,FIa:b,newValue:a.value},c)};function sZf(a,b){var c=a.D.Ua(),d=pZf(a,b);b=Tnc(b,c);iub.qb({card:a,FIa:[b],newValue:d},iZf(a))}
function qZf(a,b){a=a.Fa("waffle-assistant-input-container"+b);b=fp("waffle-assistant-input-return-icon",a);if(document.querySelector(".waffle-assistant-input-return-icon:active")!==b){Fx(a,"waffle-assistant-input-container-focused");Fx(a,"waffle-assistant-input-container-changed");var c=fp("waffle-assistant-input-edit-icon",a);P(c,!0);P(b,!1);a=fp("waffle-inline-assistant-gridrange-chip",a);Fx(a,"waffle-inline-assistant-gridrange-chip-changed");Fx(a,"waffle-inline-assistant-gridrange-chip-hovered")}}
m.g8=function(){h_(this,!0);vW(this.ob)};m.A_=function(){g_.prototype.A_.call(this);lZf(this)};m.xaa=function(a,b){var c=this.C[a];c=new Mn(c.C,new rn(c.rect.top-b,c.rect.left,c.rect.top-b+c.rect.height,c.rect.left+c.rect.width));this.C[a]=c;this.bb[a]-=b;null!==this.cb("waffle-inline-assistant-gridrange-chip")&&(this.Vf("waffle-inline-assistant-gridrange-chip")[a].childNodes[0].nodeValue=cM(c.rect))};m.xO=ba();m.K9=ba();
function pZf(a,b){a=a.Fa("waffle-assistant-input-container"+b);return(a=fp("jfk-textinput",a))?a.value:null}m.getColumnType=g("Va");function nZf(a){switch(a.toUpperCase()){case "LOCATION":return 11;case "ADDRESS":return 12;case "PHONE NUMBER":return 13;case "COMPANY":return 14;case "FAMOUS PEOPLE":return 15;case "STOCK":return 16;case "DATETIME":return 7;case "EMAIL ADDRESS":return 9;default:return 0}}
function tZf(a,b,c){a=Qne(a.L);switch(b){case 4:case 5:case 6:case 7:a=ia(a);for(var d=a.next();!d.done;d=a.next())if(d=d.value.fF,d.getType()===b)return bh(d,2)}return c}function uZf(a,b){a=ritz_api.TablesApi.getCurrentlyDetectedTables(rWf(a.Kb()).sb());return a.length?id(a,function(c){return hG(mo(ritz_api.TablesApi.getTableGridRange(c))).intersects(b)}):null}
function vZf(){this.Ba=!1;this.J=[];this.R=[];this.O=[];this.ma=[];this.L=[];this.V=[];this.F=[];this.H=[];this.va=[];this.C=this.D=this.Ea=this.Ja=null}function wZf(a,b,c,d,e,f,h,k){a.Ja=b;a.J=c;a.R=d;a.O=e;a.ma=f;a.L=h;a.V=k}function xZf(a,b,c,d,e){A.call(this);this.H=a;this.F=b;this.C=e;this.D=AV(this.F)}r(xZf,A);
function yZf(a,b){if(z(y(),"fecad")){var c=jM(a.H);if(c){a.C.F=[];a.C.H=[];a.C.va=[];var d=ritz_api.RitzModelApi.getWorkbookRangesForSheet(a.D,12);d=ia(d);for(var e=d.next();!e.done;e=d.next()){var f=e.value;e=Sn(IYc,ritz_api.RitzModelApi.getWorkbookRangePropertiesDeltaProtoById(f));if(f=ritz_api.RitzModelApi.getWorkbookRangeById(f,!1))if(f=mo(f),f.gb()===c.Kb()){var h=new rn(f.kc(),f.Qb(),f.Sc(),f.Wc());h=new Mn(a.D,h);e=ao(e.qg(11,OVf),4);a.C.F.push(h);a.C.H.push(e);e=wI(c.lh(f.kc(),f.Qb()));a.C.va.push(e);
b.push(h)}}}}}function zZf(a,b,c,d,e,f,h){g_.call(this,a,b,[c],e,f,h);this.bb=d;this.H=C(d,1);this.V=C(d,4);this.L=d.getPattern();this.Xa=C(d,5);this.Va=new Hl;this.Ea=new cA;this.Ga(this.Ea);this.Ra=null}r(zZf,g_);m=zZf.prototype;
m.Ia=function(){var a=this;g_.prototype.Ia.call(this);this.Ea.Wa(this.Fa("waffle-inline-assistant-nf-check"));Yz(this.ma,this.Ea,hub,Zz,function(){return a},iZf(this));var b=this.Fa("waffle-inline-assistant-recommendation-container");this.getHandler().listen(b,"mouseenter",this.ODb).listen(b,"mouseleave",this.RDb)};m.kja=function(){var a=new Dk;L(a,21,1);L(a,22,this.L);L(a,24,this.V);return a};m.JT=ea("number-format");
m.Ca=function(){var a=RL(this.C[0].rect.left),b=AZf(this,this.V),c=AZf(this,this.H,this.L);b=ny(OYf,{column:a,Hcc:b,Gcc:c,eRb:1===this.V&&(2===this.H||4===this.H||3===this.H),IOb:1<this.Xa});this.pb(b);b=BZf(this.H);c={};this.Na=(c.recommendationCategory="NUMBER_FORMAT",c.recommendationRange=a,c.recommendationType=b.toLocaleUpperCase(),c.recommendationPattern=this.L,c);if("#,##0.00;(#,##0.00)"===this.L||"_($* #,##0.00_);_($* \\(#,##0.00\\);_($* -??_);_(@_)"===this.L)a=this.Fa("waffle-inline-assistant-recommendation-container"),
b=this.Fa("waffle-inline-assistant-gridrange-chip"),c=this.Fa("waffle-assistant-input-reject-icon"),Gw(a,"72px"),Gw(b,"72px"),nw(b,"line-height","72px"),Gw(c,"72px"),nw(c,"line-height","72px")};
function AZf(a,b,c){if(1===b)return["TEXT"];var d=new lh;d.setType(b);D(d,3,1);c&&d.setPattern(c);if("#,##0.00;(#,##0.00)"===c||"#,##0.00;(#,##0.00)"===a.L||"_($* #,##0.00_);_($* \\(#,##0.00\\);_($* -??_);_(@_)"===c||"_($* #,##0.00_);_($* \\(#,##0.00\\);_($* -??_);_(@_)"===a.L)return[ritz_api.RitzModelApi.renderNumberAsFormattedString(1000.12,Jl(a.Va.sb(d),dg)),ritz_api.RitzModelApi.renderNumberAsFormattedString(-1000.12,Jl(a.Va.sb(d),dg))];b=1000.12;5===a.V||6===a.V||7===a.V||5===a.H||6===a.H||7===
a.H?b=39717.66597222222:3===a.H&&(b=.1012);return[ritz_api.RitzModelApi.renderNumberAsFormattedString(b,Jl(a.Va.sb(d),dg))]}function BZf(a){switch(a){case 1:return"Text";case 2:return"Number";case 3:return"Percentage";case 4:return"Currency";case 5:return"Date";case 6:return"Time";case 7:return"Date time";case 8:return"Scientific";default:return"Unknown"}}
m.ODb=function(){var a=this.C[0].rect;kZf(this);sP(this.D,Math.max(0,a.top-2),a.left);a=this.Fa("waffle-inline-assistant-gridrange-chip");Dx(a,"waffle-inline-assistant-gridrange-chip-hovered");wW(this.J,this.C[0]);a=a.childNodes[0];this.Ra=a.nodeValue;a.nodeValue="";this.Ja[0].setVisible(!0)};m.J4=ea("waffle-assistant-input-reject-icon");
m.RDb=function(){var a=this.Fa("waffle-inline-assistant-gridrange-chip");Fx(a,"waffle-inline-assistant-gridrange-chip-hovered");vW(this.J);lZf(this);a.childNodes[0].nodeValue=this.Ra;this.Ra=null;this.Ja[0].setVisible(!1)};m.g8=function(){h_(this,!0);this.xO();this.K9();var a=this.Fa("waffle-inline-assistant-nf-row");Dx(a,"waffle-inline-assistant-nf-row-with-feedback")};m.A_=function(){h_(this,!1);this.La().blur();this.xO();var a=this.Fa("waffle-inline-assistant-nf-row");Fx(a,"waffle-inline-assistant-nf-row-with-feedback")};
m.xaa=ba();m.K9=function(){this.O=ritz_api.GridViewApi.previewRangeWithNf(this.D.L.H,QWe(this.C[0]).sb(),this.jb,this.H,this.L);vIc(this.D,[this.C[0].rect])};m.xO=function(){this.O&&(ritz_api.GridViewApi.clearTransform(this.D.L.H,this.O),this.O=null,this.D.isDisposed()||vIc(this.D,[this.C[0].rect]))};function CZf(a){var b=new lh;b.setPattern(a.L);b.setType(a.H);return b}
function DZf(a,b,c,d,e){Q.call(this,e);this.H=a;this.C=b;a=ia(b);for(b=a.next();!b.done;b=a.next())this.qa(b.value);this.J=c;this.L=d;this.D=new Q(e);this.Ga(this.D);this.F=new cA;this.Ga(this.F)}r(DZf,Q);
DZf.prototype.Ca=function(){var a=this;Q.prototype.Ca.call(this);var b=ny($Yf,{odb:this.J,uja:this.C.length-3});this.pb(b);this.D.Wa(this.Fa("waffle-inline-assistant-sidebar-category-cards"));if("anomaly"===this.H)EZf(this).forEach(function(c){for(var d=0,e=0;e<c.length;e++){var f=i_(c[e]);d+=f.length}d=ny(aZf,{l8b:d,VK:c[0].getColumnType()});a.D.La().appendChild(d);for(d=0;d<c.length&&3>d;d++)a.D.Ga(c[d],!0)});else for(b=0;b<this.C.length&&3>b;b++)this.D.Ga(this.C[b],!0)};
function EZf(a){var b=new Map;if("anomaly"!==a.H)return b;for(var c=0;c<a.C.length;c++){var d=a.C[c],e=i_(d)[0];if(b.has(e.left)){var f=b.get(e.left);f=f.concat(d);b.set(e.left,f)}else b.set(e.left,[d])}return b}DZf.prototype.Ia=function(){Q.prototype.Ia.call(this);this.F.Wa(this.Fa("waffle-inline-assistant-sidebar-category-show-more-button"));"anomaly"===this.H||3>=this.C.length?FZf(this):this.getHandler().listen(this.F,"action",this.O)};
function GZf(a,b){var c=a.C.indexOf(b);a.C.splice(c,1);if(b.isVisible()){if("anomaly"===a.H){var d=b.La().previousElementSibling,e=EZf(a),f=i_(b)[0].left;e.has(f)||(e=a.D.La(),Cx(d,"waffle-assistant-anomaly-description"),e.removeChild(d))}Ap(b.La(),document.activeElement)&&(c+1<a.tc()?a.Bc(c+1).La().focus():0<=c-1&&a.Bc(c-1).La().focus());a.D.removeChild(b,!0)}else a.C.length===a.D.tc()?FZf(a):(c=ny(ZYf,{uja:a.C.length-a.D.tc()}),a.F.La().childNodes[1].nodeValue=c.textContent);b.dispose()}
DZf.prototype.O=function(){for(var a=this.D.tc(),b=a;b<this.C.length;b++)this.D.Ga(this.C[b],!0);this.C[a].La().focus();FZf(this);a=new Dk;L(a,23,this.C.length);switch(this.H){case "anomaly":L(a,21,3);break;case "remove-duplicates":L(a,21,4);break;case "number-format":L(a,21,1);break;case "trim-whitespace":L(a,21,2)}a=fz(ez(bz(new az,76),a));this.L.C(36811,a)};function FZf(a){a.F.Pa(!1);a.F.setVisible(!1)}
function HZf(a,b,c,d,e,f,h){g_.call(this,a,b,[c],e,f,h);this.Ra=d;this.F=ah(d,5).concat(ah(d,6));this.V=C(d,2);this.L=C(d,3);this.Ea=C(d,4);this.H=new cA;this.Ga(this.H)}r(HZf,g_);m=HZf.prototype;m.kja=function(){var a=new Dk;L(a,21,4);var b=new Ek;L(b,1,this.F.length-1);zXe(a,b);return a};m.JT=ea("remove-duplicates");
m.Ia=function(){var a=this;g_.prototype.Ia.call(this);for(var b=this.Vf("waffle-inline-assistant-recommendation-container"),c={FP:0};c.FP<this.F.length;c={FP:c.FP},c.FP++){var d=b[c.FP];this.getHandler().listen(d,"mouseenter",function(e){return function(){var f=e.FP,h=a.Vf("waffle-inline-assistant-gridrange-chip")[f],k=a.F[f],l=new Mn(a.C[0].C,new rn(k,a.V,k+1,a.L));0===f?wW(a.J,l):wW(a.Sa,l);kZf(a);a.D.mL(k);Dx(h,"waffle-inline-assistant-gridrange-chip-hovered")}}(c)).listen(d,"mouseleave",function(e){return function(){var f=
e.FP;f=a.Vf("waffle-inline-assistant-gridrange-chip")[f];vW(a.J);vW(a.Sa);Fx(f,"waffle-inline-assistant-gridrange-chip-hovered");lZf(a)}}(c))}this.H.Wa(this.Fa("waffle-inline-assistant-accept-button"));Yz(this.ma,this.H,lub,Zz,function(){return a},iZf(this))};
m.Ca=function(){for(var a=cM(this.C[0].rect),b=this.D.Ua(),c=[],d=this.V;5>d&&d<this.L;d++){var e=b.lh(this.F[0],d);c.push(wI(e))}b=ny(YYf,{wec:this.F,X3:c});this.pb(b);b={};this.Na=(b.recommendationCategory="REMOVE_DUPLICATES",b.recommendationRange=a,b.recommendationFirstRow=(this.F[0]+1).toString(),b)};m.g8=function(){h_(this,!0)};m.A_=function(){h_(this,!1);this.La().blur()};
m.xaa=function(a,b){this.F[a]-=b;this.isVisible()&&(a=this.Vf("waffle-inline-assistant-gridrange-chip")[a],a.childNodes[0].nodeValue=(a.childNodes[0].nodeValue-b).toString())};m.K9=ba();m.xO=ba();function IZf(a,b,c,d,e,f,h){g_.call(this,a,b,c,e,f,h);this.V=d;this.Ea=dd(ah(d,1),function(k,l){return k+l},0);this.H=cd(c,function(k){return k.rect.top});this.L=new cA;this.Ga(this.L)}r(IZf,g_);m=IZf.prototype;m.kja=function(){var a=new Dk;L(a,21,2);var b=new Ek;L(b,1,this.H.length);zXe(a,b);return a};
m.JT=ea("trim-whitespace");
m.Ca=function(){for(var a=this.C,b=[],c=[],d=ia(a),e=d.next();!e.done;e=d.next()){var f=e.value.rect;e=cM(f);var h=wI(this.D.Ua().lh(f.top,f.left));f=h.trimStart();var k=h.length-f.length,l=h.trim();f=f.length-l.length;h=[];for(var n=0;n<k;n++)h.push(null);k=!1;l=ia(l);for(n=l.next();!n.done;n=l.next())n=n.value,n.match("\\s")?k?h.push(null):(k=!0,h.push(n)):(h.push(n),k=!1);for(k=0;k<f;k++)h.push(null);b.push(h);c.push(e)}b=ny(RYf,{lU:c,qdb:b});this.pb(b);a=RL(a[0].rect.left);b={};this.Na=(b.recommendationCategory=
"TRIM_WHITESPACE",b.recommendationRange=a,b.recommendationNumWhitespaces=this.Ea.toString(),b)};
m.Ia=function(){var a=this;g_.prototype.Ia.call(this);for(var b=this.Vf("waffle-inline-assistant-recommendation-container"),c={HP:0};c.HP<this.C.length;c={HP:c.HP},c.HP++){var d=b[c.HP];this.getHandler().listen(d,"mouseenter",function(e){return function(){var f=e.HP,h=a.C[f];wW(a.Sa,h);kZf(a);sP(a.D,h.rect.top,h.rect.left);h=a.Vf("waffle-inline-assistant-gridrange-chip")[f];Dx(h,"waffle-inline-assistant-gridrange-chip-hovered");f=a.C[f];h=ritz_api.GridViewApi.previewRangeWithApplyTrimWhitespace(a.D.L.H,
QWe(f).sb());a.O=h;vIc(a.D,[f.rect])}}(c)).listen(d,"mouseleave",function(e){return function(){var f=e.HP;vW(a.Sa);var h=a.Vf("waffle-inline-assistant-gridrange-chip")[f];Fx(h,"waffle-inline-assistant-gridrange-chip-hovered");a.O&&(ritz_api.GridViewApi.clearTransform(a.D.L.H,a.O),a.D.isDisposed()||(a.O=null,vIc(a.D,[a.C[f].rect])))}}(c))}this.L.Wa(this.Fa("waffle-inline-assistant-accept-button"));Yz(this.ma,this.L,mub,Zz,function(){return a},iZf(this))};m.g8=function(){h_(this,!0)};
m.A_=function(){h_(this,!1);this.La().blur();lZf(this)};m.xaa=function(a,b){var c=this.C[a];c=new Mn(c.C,new rn(c.rect.top-b,c.rect.left,c.rect.top-b+c.rect.height,c.rect.left+c.rect.width));this.C[a]=c;this.H[a]-=b;null!==this.cb("waffle-inline-assistant-gridrange-chip")&&(this.Vf("waffle-inline-assistant-gridrange-chip")[a].childNodes[0].nodeValue=cM(c.rect))};m.K9=ba();m.xO=ba();
m.hta=function(a,b){for(var c=b.length-1;0<=c;c--)ah(this.V,1).splice(b[c],1);return new IZf(this.jb,this.wb,a,this.V,this.fb,this.R)};function JZf(a,b,c,d,e,f){Q.call(this,f);this.L=b;this.R=c;this.J=d;this.O=e;this.C=this.F=this.H=this.D=null;this.V=ny(WYf)}r(JZf,Q);JZf.prototype.Ca=function(){Q.prototype.Ca.call(this);Dx(this.getElement(),"waffle-inline-assistant-sidebar-section")};JZf.prototype.Ia=function(){Q.prototype.Ia.call(this);this.ub().appendChild(this.V)};
function KZf(a,b,c){a.C&&(a.removeChild(a.C,!0),a.C.dispose());if(c.length){var d=vJ(a.L);if(d){var e=d.Ua();d=[];for(var f={},h=0;h<b.length;h++){var k=b[h],l=c[h],n=k.rect,q=d0b(e.lh(n.top,n.left),e.Kb(),n.top,n.left),t=l+q+n.left,w=t in f?f[t].vG:[];w.push(k);f[t]={VK:l,EIa:q,vG:w,Zdb:n.left}}b=LZf(f);c=ia(b.keys());for(e=c.next();!e.done;e=c.next())e=b.get(e.value),e=new mZf(a.R,a.L,e.vG,e.VK,e.ioa,e.UUa,a.J,a.O),d.push(e);d.sort(function(x,F){x=i_(x)[0];F=i_(F)[0];return x.left!=F.left?x.left-
F.left:x.top-F.top});a.C=new DZf("anomaly",d,"Fix invalid data",a.J);a.Ga(a.C)}}}function LZf(a){var b=new Map,c;for(c in a){var d=a[c];if(1<d.vG.length){var e=Array(d.vG.length).fill(d.EIa);b.set(c,{VK:d.VK,vG:d.vG,UUa:!0,ioa:e})}else{e="NON_BULK"+d.Zdb+d.VK;var f=b.has(e)?b.get(e).vG:[];f.push(d.vG[0]);var h=b.has(e)?b.get(e).ioa:[];h.push(d.EIa);b.set(e,{VK:d.VK,vG:f,UUa:!1,ioa:h})}}return b}function MZf(a){var b=[];a.F&&b.push(a.F);a.C&&b.push(a.C);a.D&&b.push(a.D);a.H&&b.push(a.H);return b}
function j_(a,b,c){var d=NZf(a,b.JT());if(c&&0<c.length){for(var e=d.C.indexOf(b),f=ja(b.C).concat(),h=c.length-1;0<=h;h--)f.splice(c[h],1);1<=f.length?(c=b.hta(f,c),b.isVisible()&&(d.D.Kf(c,e,!0),d.D.removeChild(b,!0)),d.C[e]=c,b.dispose()):GZf(d,b)}else GZf(d,b);if(0===d.C.length)switch(Ap(d.La(),document.activeElement)&&(e=MZf(a),d=e.indexOf(d)+1,d<e.length?e[d].La().focus():a.cb("waffle-inline-assistant-sidebar-insights-cta").focus()),b.JT()){case "number-format":a.D.dispose();a.D=null;break;
case "trim-whitespace":a.H.dispose();a.H=null;break;case "remove-duplicates":a.F.dispose();a.F=null;break;case "anomaly":a.C.dispose(),a.C=null}}function OZf(a){Uf(a.yd(!0));a.C=null;a.F=null;a.D=null;a.H=null}function PZf(a){return(a.C?a.C.C:[]).concat(a.F?a.F.C:[],a.D?a.D.C:[],a.H?a.H.C:[])}function NZf(a,b){switch(b){case "number-format":return a.D;case "trim-whitespace":return a.H;case "remove-duplicates":return a.F;case "anomaly":return a.C}}
function QZf(a,b){a=a||{};var c='<div class="'+U("waffle-inline-assistant-sidebar-container")+'"><div class="'+U("waffle-inline-assistant-sidebar-column-filter-dropdown-container")+'"><div class="'+U("waffle-inline-assistant-sidebar-column-filter-dropdown")+'" aria-label="';c+=jx("Filter suggestions by column");c+='"></div></div><div class="'+U("waffle-inline-assistant-sidebar-empty-container")+'"><div class="'+U("waffle-inline-assistant-sidebar-empty-message")+'">';c=c+'No suggestions available</div></div><div class="'+
(U("waffle-inline-assistant-sidebar-accepted-container")+'"><div class="'+U("waffle-inline-assistant-sidebar-accepted-message")+'">');c=c+"Data clean-up suggestions have been applied</div>"+R(bA({hd:"waffle-inline-assistant-sidebar-accept-back",content:"Back",style:2},b));c+="</div></div>";var d='<div class="'+U("waffle-inline-assistant-refresh-banner")+'"><div class="'+U("waffle-inline-assistant-refresh-text-container")+'"><div class="'+U("waffle-inline-assistant-refresh-text")+'">';d=d+'Refresh to see the latest suggestions.</div><div class="'+
(U("waffle-inline-assistant-refresh-button jfk-button-standard")+'">');d+="Refresh</div></div></div>";a=""+R(TW(ex({title:"Data clean-up",Gl:hx(c),Ce:!0,id:"inlineassistant",Cx:"waffle-inline-assistant-sidebar",bG:hx('<img class="docs-icon docs-auto-fix" aria-hidden="true" src="https://www.gstatic.com/images/icons/material/system/1x/auto_fix_black_24dp.png"/>'),fX:!0,f6:hx(d)},a),b));return T(a)}
function RZf(a){Q.call(this,a);this.C=new Q;this.Ga(this.C);this.J=E1e("");this.Ga(this.J);this.O=new Wz(void 0,void 0,void 0,MB.getInstance());this.qa(this.O);this.F=new Rq(this.RZa,3E3,this);this.qa(this.F);this.L=new zB(this.oa());this.qa(this.L);this.D=null;this.H=0}r(RZf,Q);m=RZf.prototype;m.Ca=function(){var a=ny(SYf);this.pb(a)};m.show=function(){var a=this.La();P(a,!0);Fx(a,"waffle-inline-assistant-sidebar-toast-hidden");AB(this.L,this.C.La().textContent,"assertive");this.F.start()};
m.RZa=function(){Dx(this.La(),"waffle-inline-assistant-sidebar-toast-hidden")};m.isVisible=function(){return Kw(this.La())};m.$6b=function(){this.F.stop()};m.a7b=function(){this.F.start(1E3)};function SZf(a,b){var c=ny(TYf,{m8b:b});a.C.La().textContent=c.textContent;a.H=b}
m.Ia=function(){var a=this;Q.prototype.Ia.call(this);this.J.Wa(this.Fa("waffle-inline-assistant-toast-undo-button"));Yz(this.O,this.J,kub,Zz,void 0,function(){var c=new Dk;if(null!==a.D){L(c,21,a.D);var d=new Ek;L(d,1,a.H);zXe(c,d)}return fz(ez(bz(new az,76),c))});this.C.Wa(this.Fa("waffle-inline-assistant-toast-text"));var b=this.La();this.getHandler().listen(this.J,"action",this.RZa).listen(b,"mouseenter",this.$6b).listen(b,"mouseleave",this.a7b)};
function TZf(a,b,c,d,e,f,h){xW.call(this,h);var k=this;this.L=b;this.ma=d;this.D=new JZf(a,b,c,e,f,h);this.Ga(this.D);this.O=OB(new NB);this.qa(this.O);this.R=new cA;this.Ga(this.R);Yz(this.O,this.R,Tub);this.F=new aW(new sz);Jz(this.F,"All columns");this.Ga(this.F);Yz(this.O,this.F,gub,this.F.J(),function(){return k.F.vf().getValue()},function(){var l=new Dk,n=0===k.F.ji();L(l,33,n);return fz(ez(bz(new az,76),l))});this.J=null;this.V=new cA;this.Ga(this.V);Yz(this.O,this.V,nub);this.H=new RZf;this.Ga(this.H)}
r(TZf,xW);
TZf.prototype.Ia=function(){var a=this;xW.prototype.Ia.call(this);this.getHandler().listen(this.La(),"click keyup keydown mousemove mouseover mouseenter mouseout".split(" "),function(){return void a.dispatchEvent("dataprep-sidebar-interaction-event")});A8e(this,!0);var b=this.Fa("waffle-inline-assistant-sidebar-empty-container");P(b,!1);b=this.Fa("waffle-inline-assistant-sidebar-accepted-container");P(b,!1);this.R.Wa(this.Fa("waffle-inline-assistant-sidebar-insights-cta"));this.F.render(this.Fa("waffle-inline-assistant-sidebar-column-filter-dropdown"));this.V.Wa(this.Fa("waffle-inline-assistant-refresh-button"));
UZf(this,!1)};TZf.prototype.Ca=function(){var a=ny(QZf);this.pb(a);this.H.render(a);P(this.H.La(),!1);a=this.ub();this.D.render(a)};function VZf(a){if(z(y(),"fecei")&&null===a.J){var b=AV(a.L),c=vJ(a.L);a.J=ritz_api.GridViewApi.displayColumnErrorIcons(ritz_api.RitzModelApi.getTopLevelModel(),c.L.F,b);t0e(c)}}function WZf(a){if(null!==a.J){var b=vJ(a.L);b&&(ritz_api.GridViewApi.clearColumnHeaderTransform(b.L.F,a.J),a.J=null,t0e(b),MVf(b,[]))}}
TZf.prototype.setVisible=function(a){var b={};ZA(this.ma,(b.Me=a,b));b=vJ(this.L);this.isVisible()===a||!b&&a||(xW.prototype.setVisible.call(this,a),a?(A8e(this,!0),VZf(this),UZf(this,!1)):(OZf(this.D),WZf(this)))};
TZf.prototype.initialize=function(a,b,c,d,e,f,h,k,l){A8e(this,!1);OZf(this.D);var n=this.Fa("waffle-inline-assistant-sidebar-accepted-container");P(n,!1);n=this.Fa("waffle-inline-assistant-sidebar-empty-container");var q=this.Fa("waffle-inline-assistant-sidebar-column-filter-dropdown");if(a&&(b.length&&c.length||d.length&&e.length||f.length&&h.length||0!==k.length)){var t=new sz,w=mo(ritz_api.TablesApi.getTableGridRange(a));a=w.Qb();w=w.Wc();for(t.Ga(new nz("All columns"),!0);a<w;a++)t.Ga(new nz("Column "+
RL(a)),!0);t.setVisible(!1,!0);t.render();this.F.Je(t);P(q,!0);P(n,!1);if(b.length&&c.length&&(n=this.D,n.D&&(n.removeChild(n.D,!0),n.D.dispose()),c.length)){q=[];for(t=0;t<c.length;t++)a=new zZf(n.R,n.L,b[t],c[t],n.J,n.O),q.push(a);n.D=new DZf("number-format",q,"Apply format to columns",n.J);n.Ga(n.D)}if(d.length&&e.length&&(b=this.D,b.H&&(b.removeChild(b.H,!0),b.H.dispose()),e.length)){c=[];for(n=0;n<e.length;n++)q=new IZf(b.R,b.L,d[n],e[n],b.J,b.O),c.push(q);b.H=new DZf("trim-whitespace",c,"Trim whitespace",
b.J);b.Ga(b.H)}if(f.length&&h.length&&(d=this.D,d.F&&(d.removeChild(d.F,!0),d.F.dispose()),h.length)){e=[];for(b=0;b<h.length;b++)c=new HZf(d.R,d.L,f[b],h[b],d.J,d.O),e.push(c);d.F=new DZf("remove-duplicates",e,"Remove duplicate rows",d.J);d.Ga(d.F)}0!==k.length&&KZf(this.D,k,l);f=this.D;h=MZf(f);h=ia(h);for(k=h.next();!k.done;k=h.next())Uw(k.value,f.V);VZf(this)}else P(n,!0),OZf(this.D),P(q,!1)};function XZf(a,b){var c=a.H;SZf(c,b);c.D=2;a.H.show()}
function YZf(a,b){var c=a.H;SZf(c,b);c.D=3;a.H.show()}function ZZf(a,b){var c=a.H;b=ny(UYf,{eeb:b});c.C.La().textContent=b.textContent;c.D=1;c.H=0;a.H.show()}function $Zf(a,b){var c=a.H,d=ny(VYf,{p8b:b});c.C.La().textContent=d.textContent;c.D=4;c.H=b;a.H.show()}function UZf(a,b){a=a.Fa("waffle-inline-assistant-refresh-banner");P(a,b)}function a_f(a){bo.call(this,a)}r(a_f,bo);a_f.prototype.getRange=function(){return this.message.getRange()};function b_f(a){a.Qwa(2,3,4,5,6,7)}
function c_f(a){this.Eb=Nn(a,-1,0)}r(c_f,Rn);c_f.prototype.fc=function(){return new a_f(this)};c_f.prototype.getRange=function(){return this.qg(1,lo)};function d_f(a){bo.call(this,a)}r(d_f,bo);function e_f(a){this.Eb=Nn(a,-1,0)}r(e_f,Rn);e_f.prototype.fc=function(){return new d_f(this)};function f_f(a,b,c){pJ.call(this,150);this.mb=a;this.F=b;this.C=c}r(f_f,pJ);
f_f.prototype.Ld=function(){var a=void 0===a?Tn(e_f):a;a=new d_f(a);for(var b=0;b<this.C.length;b++){var c=this.C[b],d=this.F[b],e=void 0;e=void 0===e?Tn(c_f):e;e=new a_f(e);var f=this.mb.Kb();d=fG(d,f);jo(e,1,d);switch(c.H){case 32:c=c.Ld();b_f(e);jo(e,7,c);break;case 134:c=c.Ld();b_f(e);jo(e,4,c);break;case 138:c=c.Ld();b_f(e);jo(e,3,c);break;case 1:c=c.Ld();b_f(e);jo(e,2,c);break;case 151:c=c.Ld();b_f(e);jo(e,6,c);break;case 55:c=c.Ld();b_f(e);jo(e,5,c);break;default:continue}e=co(e);io(a,1,e)}return co(a)};
f_f.prototype.Fg=ea(!1);function g_f(a,b,c,d,e){MV.call(this,a,c);this.C=a;this.H=b;this.F=d;this.J=e;this.L=null;this.va=new qdf(b,e,a);this.qa(this.va);this.ma=this.V=!1;this.D=new Rq(this.cmb,2E3,this);this.qa(this.D);a=new Uz(this);a.yb(Tub,mt,this.vBb);this.qa(a)}r(g_f,MV);m=g_f.prototype;m.initialize=function(a,b,c,d,e,f,h,k,l,n){this.L=n;this.C.initialize(a,b,c,d,e,f,h,k,l)};m.show=function(){NV(this)};
m.sM=function(){this.J.C(36588,fz(ez(bz(new az,76),this.L)));this.ma&&this.J.C(36834,fz(ez(bz(new az,76),this.L)));for(var a=ia(PZf(this.C.D)),b=a.next();!b.done;b=a.next())this.J.C(36583,iZf(b.value));WZf(this.C);this.ma=!1;MV.prototype.sM.call(this)};function h_f(a,b){var c=jM(a.H);if(c){var d=i_(b);c=new f_f(c,d,[new YAe(c,d[0],CZf(b))]);qJ(c,function(e){e&&a.D.start()});a.F.C(c);ZZf(a.C,RL(d[0].left));j_(a.C.D,b,void 0)}}
function i_f(a,b){var c=jM(a.H);if(c){var d=i_(b)[0],e=new uh;Zna(e,d.Qb());$na(e,d.Wc());c=new wdf(c,d,[e],b.Ea,b.F);qJ(c,function(f){f&&a.D.start()});a.F.C(c);$Zf(a.C,b.F.slice(1,b.F.length).length);j_(a.C.D,b,void 0);j_f(a,b)}}function k_f(a,b){var c=jM(a.H);if(c){var d=i_(b);c=new f_f(c,d,d.map(function(){return new aBe}));qJ(c,function(e){e&&a.D.start()});a.F.C(c);XZf(a.C,d.length);j_(a.C.D,b,void 0)}}
function j_f(a,b){var c=PZf(a.C.D);b=b.F;for(var d=0;d<c.length;d++){var e=c[d],f=[];switch(e.JT()){case "remove-duplicates":f=e.F;break;case "trim-whitespace":f=e.H;break;case "anomaly":f=e.bb}for(var h=b.slice(1,b.length),k=[],l=0;l<f.length;l++){var n=xd(h,f[l]);0>n?(n=-1*(n+1),0<n&&e.xaa(l,n)):k.push(l)}0<k.length&&j_(a.C.D,e,k)}}
function l_f(a,b,c,d){var e=jM(a.H);if(e){var f=new f_f(e,c,c.map(function(q){return new oyd(e,new Vm(q.left,q.top),d)}));qJ(f,function(q){q&&a.D.start()});a.F.C(f);YZf(a.C,c.length);f=i_(b);if(f.length===c.length)j_(a.C.D,b,void 0);else{for(var h=[],k=ia(c),l=k.next();!l.done;l=k.next()){l=l.value;for(var n=0;n<f.length;n++)if(f[n].equals(l)){h.push(n);break}}j_(a.C.D,b,h)}m_f(a,c)}}
function m_f(a,b){var c=PZf(a.C.D),d=b[0].left;b=cd(b,function(n){return n.top});for(var e=0;e<c.length;e++){var f=c[e],h=[];switch(f.JT()){case "remove-duplicates":h=f.F;for(var k=0;k<h.length;k++)if(0<=xd(b,h[k])){j_(a.C.D,f,void 0);break}break;case "trim-whitespace":if(f.C[0].rect.left===d){h=f.H;k=[];for(var l=0;l<h.length;l++)0<=xd(b,h[l])&&k.push(l);j_(a.C.D,f,k)}}}}m.vBb=function(){Tf(this.va);U4b(!0)};m.isVisible=function(){return this.hg().isVisible()};m.hg=function(){return cub};m.hq=function(){return dub};
function n_f(a){a.V=!0;a.ma=!0}m.cmb=function(){this.V=!1};
function o_f(a,b,c,d,e,f,h,k,l,n,q,t){A.call(this);var w=this;this.F=a;this.O=b;this.Ra=c;this.Za=d;this.Bb=e;this.ob=h;this.J=f;fqc(this.J,this.F,this.Bb,this.Za);this.wb=k;this.bb=l;this.rb=q;this.Hb=t;this.D=null;this.L=[];this.C=new vZf;this.Va=this.V=this.Qa=this.Na=this.Ea=this.Sa=this.ma=!1;this.H=AV(this.O);this.Ba=new Map;this.R=new Rq(this.nya,void 0,this);this.qa(this.R);this.va=null;this.fb=new Vo(this);this.qa(this.fb);this.Xa=new xZf(a,b,c,this.Ba,this.C,this.L);this.Ja=0;this.fb.listen(this.J,
"recommender-calc-ended",this.f8).listen(this.J,"recommender-calc-failed",this.Nsb).listen(nG(this.F.C),"Rb",this.NHb).listen(this.F.C,"pa",this.X6b).listen(nG(this.F.C),"Fc",this.q4a).listen(this.rb.Qa,"sheet-imported",this.W6b);this.jb=new Uz(this);this.qa(this.jb);this.jb.yb(LC,mt,this.JRa).yb(cub,ht,function(x){x.newValue&&!w.Sa?w.JRa():w.Sa=!1}).yb(lub,mt,this.cIb).yb(hub,mt,this.SEb).yb(mub,mt,this.ZMb).yb(iub,mt,this.qLb).yb(gub,mt,this.xQa).yb(jub,mt,this.KAb).yb(nub,mt,this.QZa).yb(kub,mt,
this.Y6b);p_f(this)}r(o_f,A);m=o_f.prototype;m.cIb=function(a){n_f(this.D);var b=a.data;i_f(this.D,b);a=this.C.V;b=a.indexOf(b.Ra);0>b||(a.splice(b,1),this.C.L.splice(b,1),this.C.C=null,this.C.D=null)};m.SEb=function(a){n_f(this.D);var b=a.data;h_f(this.D,b);a=this.C.R;b=a.indexOf(b.bb);0>b||(a.splice(b,1),this.C.J.splice(b,1),this.C.C=null,this.C.D=null,q_f(this))};
m.ZMb=function(a){n_f(this.D);var b=a.data;k_f(this.D,b);a=this.C.ma;b=a.indexOf(b.V);0>b||(a.splice(b,1),this.C.O.splice(b,1),this.C.C=null,this.C.D=null,q_f(this))};m.qLb=function(a){n_f(this.D);l_f(this.D,a.data.card,a.data.FIa,a.data.newValue);q_f(this)};
function q_f(a){if(z(y(),"fecei")){for(var b=new Set,c=ia(a.C.F),d=c.next();!d.done;d=c.next())d=d.value,1==Fn(d.rect,"c")&&b.add(d.rect.Qb());c=vJ(a.O);null!=c&&(MVf(c,Array.from(b)),(new Rq(function(){var e=vJ(a.O);e&&t0e(e)},300)).start())}}
m.xQa=function(){var a=this.D.C.F,b=a.vf().getValue(),c=a.La();a=fp("docs-material-gm-labeled-select-outer-box",c);c=fp("docs-material-gm-labeled-select-caption",c);"All columns"===b?(r_f(this),nw(a,"background-color",""),nw(c,"color","")):(r_f(this,Vnc(b.slice(7))),nw(a,"background-color","#E6F4EA"),nw(c,"color","#188038"))};m.KAb=function(a){var b=a.data.card;if(1===b.Vf(b.J4()).length)j_(this.D.C.D,b,void 0);else{var c=this.D;a=a.data.Uhc;void 0===a?j_(c.C.D,b,void 0):j_(c.C.D,b,[a])}q_f(this)};
function p_f(a){z(y(),"fedpsoi")&&a.Hb&&(a.va=500,a.R.start(a.va),a.Qa=!0)}function s_f(a,b){return a.H?b.filter(function(c){c=ro(yV(c));return c.C!=a.H?!1:nM(a.F,c.C||a.H,c.rect,!1)}):[]}m.W6b=function(a){a=a.Rh;if(ZH(this.F.C,a)){var b=new vZf;this.Ba.set(a,b);a===this.H&&(this.C=b)}this.V=!0;p_f(this)};m.JRa=function(){this.ma=!0;this.nya();t_f(this);u_f(this)};
function t_f(a){if(jM(a.F)){if(!a.D){var b=new TZf(a.F.F,a.O,a.F.L.C,a.ob,a.Ra,a.F.R.qq());a.qa(b);b.render();a.D=new g_f(b,a.F,a.wb,a.bb,a.Ra);a.qa(a.D)}a.Sa=!0;a.D.show()}}m.QZa=function(){this.C.C=null;this.Ea=!0;this.R.start(150);UZf(this.D.C,!1)};m.q4a=function(){v_f(this)&&(this.C.C=null,UZf(this.D.C,!0))};m.Y6b=function(){Toe(this.bb.D);this.C.C=null;this.QZa();this.Va=!0};
function r_f(a,b){a.Na=!1;a.Qa=!1;a.Ea=!1;u_f(a);var c=jM(a.F);if(c){var d=[];if(a.C.D&&(d=s_f(a,a.C.D.C),!a.H))return;var e=a.C.Ea,f=null;e?f=uZf(c,e.rect):(f=uZf(c,c.F))&&(e=gG(mo(ritz_api.TablesApi.getTableGridRange(f))));e=[];var h=[],k=[],l=[],n=[],q=[];d=ia(d);for(var t=d.next();!t.done;t=d.next()){var w=t.value;t=ro(yV(w));if(void 0===b||t.rect.left==b||9===C(w,1))switch(a.L.push(t),C(w,1)){case 7:var x=t.rect.left;if(ritz_api.RitzModelApi.getColumnType(c.Kb(),x))continue;w=C(w,14);x=C(w,1);
var F=w.getPattern();F=tZf(a.F.F,x,F);w.setPattern(F);l.push(w);e.push(t);break;case 8:t=C(w,15);n.push(t);h.push(ah(w,4).map(ro));break;case 9:w=C(w,16),q.push(w),k.push(t)}}c=a.C.F;w=a.C.H;d=[];t=[];if(void 0!==b)for(x=0;x<c.length;x++)c[x].rect.left==b&&(d.push(c[x]),t.push(w[x]));else d=c,t=w;t_f(a);a.ma&&(a.ma=!1,a.D.C.focus());a.D&&(w=a.F.F.F["ritz-DataPrepSuggestionsSidepaneCount"],w.setValue(w.getValue()+1),a.D.initialize(f,e,l,h,n,k,q,d,t,w_f(a,l.length+n.length+q.length+c.length).C),x_f(a,
b),b=vJ(a.O),null!=b&&LVf(b,function(M){x_f(a,M);a.xQa()}),q_f(a));wZf(a.C,f,e,l,h,n,k,q)}}function x_f(a,b){void 0===b?a.D.C.F.If(0):a.D.C.F.If(b+1)}function v_f(a){return null!=a.D&&a.D.isVisible()}
m.X6b=function(a){if(this.H){var b=v_f(this);this.C.Ba=b;this.D&&(b=this.D,b.hg().isVisible()&&("pa"===a.type?VZf(b.C):"qa"===a.type&&b.sM()));this.Ba.set(this.H,this.C);this.L=[];this.V||(this.R&&this.R.stop(),this.va=null);a=jM(this.F);null==a?(this.H=AV(this.O),this.C=new vZf):(this.H=a.Kb(),this.C=this.Ba.has(this.H)?this.Ba.get(this.H):new vZf);if(this.H){a=this.Xa;b=this.H;var c=this.C,d=this.L;b&&c&&a.D&&(a.D=b,a.C=c,yZf(a,d));if(this.C.Ba){a=this.C.Ja;b=this.C.J;c=this.C.O;d=this.C.L;var e=
this.C.F;a&&(b.length||c.length||d.length||e.length)&&(t_f(this),this.D&&this.D.initialize(a,b,this.C.R,c,this.C.ma,d,this.C.V,this.C.F,this.C.H,w_f(this,b.length+c.length+d.length+e.length).C));q_f(this)}}}};
m.NHb=function(a){if(a.C&&a.C.length)if(this.Va)this.Va=!1;else{var b=jM(this.F);if(!b)if(a.target instanceof JI)b=a.target;else return;if(v_f(this)){if(this.D.V){b&&q_f(this);return}var c=this.C.C;c&&a.C.some(function(e){return e.top<c.Sc()&&e.left<c.Wc()})&&this.q4a()}if(this.R.Gb()||v_f(this))this.va=5E3,this.R.start(this.va);b={};a=ia(a.C);for(var d=a.next();!d.done;b={E$:b.E$},d=a.next()){b.E$=d.value;if(!this.H)break;if(!this.C.C)break;if(gCa(this.C.C,b.E$)&&(!this.L||!this.L.some(function(e){return function(f){return e.E$.equals(f.rect)}}(b)))){this.C.C=
null;this.L=[];this.C.D=null;break}}}};m.Nsb=function(){2<this.Ja?(this.Ja=0,this.f8(null)):(this.Ja++,this.nya())};
m.f8=function(a){this.V=!1;this.Ja=0;if(z(y(),"fenfts")||z(y(),"fetws")||z(y(),"ferds")||z(y(),"fecad")){var b=this.J.C,c=vJ(this.O);if(this.H)if(a&&c&&b&&this.H&&b.C===this.H?(this.C.D=a,this.C.C=b.rect):(this.C.D=null,this.C.C=null),this.C.Ea=b,this.ma||this.Na||this.Ea)r_f(this);else{var d=a?s_f(this,a.C):[];a=this.C.F.length;b=d.length+a;c=1<a;var e=0,f=0,h=new Set;d=ia(d);for(var k=d.next();!k.done;k=d.next()){k=k.value;var l=C(k,1);h.add(l);7==l?(c=c||C(C(k,14),3),e++):9==l&&(c=!0,f++)}!c||
z(y(),"feadpsd")&&2>h.size||0==f&&2>e+a||!this.Qa||(r_f(this),this.Ra.C(36702,w_f(this,b)))}}};
function w_f(a,b){var c=new Dk;L(c,23,b);if(b=a.J.C){var d=new Ek;L(d,1,b.rect.height);L(d,2,b.rect.width);bk(c,10,[d])}for(var e in gZf){b=new p$d;switch(gZf[e]){case "number-format":L(b,1,1);L(b,2,a.C.J.length);break;case "trim-whitespace":L(b,1,2);L(b,2,a.C.O.length);break;case "remove-duplicates":L(b,1,4);L(b,2,a.C.L.length);break;case "anomaly":L(b,1,3);L(b,2,a.C.F.length);break;default:continue}ck(c,25,b,p$d,void 0)}return fz(ez(bz(new az,76),c))}
function u_f(a){a.H&&JVf(a.F.F.J,a.F.D.D,a.H)}
m.nya=function(){if(this.H){if(!(this.V||this.ma||this.Na||this.Ea)){var a=this.F.F.J;if(!Pj(a.C,2,!0))return;var b=this.F.D.D;a=ia(Xj(a.C,kT,1));for(var c=a.next();!c.done;c=a.next())if(c=c.value,b===K(c,1)&&this.H===c.gb())return}this.va=null;b=jM(this.F);a=xJ(this.O);b&&!this.F.Rd()&&this.F.H.C&&!pM(this.F)&&a&&!a.D?(yZf(this.Xa,this.L),a=b.F,(c=this.C.C)&&gCa(c,a)?(this.ma&&this.f8(this.C.D),this.V=!1):ZWe(this.J)?(this.J.reset(),X_e(this.J),(b=uZf(b,a))?(b=mo(ritz_api.TablesApi.getTableGridRange(b)),
this.J.L=b,g0e(this.J,!0,!0,!1,[7,8,9])):this.f8(null)):this.f8(null)):this.V=!1}};function y_f(a,b,c,d,e,f,h,k,l,n,q){MV.call(this,b,h);var t=this;this.H=a;this.C=b;this.Ea=c;this.Sa=d;this.Qa=e;this.L=f;this.D=c.C;this.Na=this.Ba=!1;this.F=null;this.V=k;this.Ra=q;this.J=null;z_f(this);yub.Pa(!0);a=new ok;L(a,6,A_f());b=new lk;sk(b,a);this.ma=fz(bz(cz(new az,b),10));this.va=-1;a=new Rq(function(){return B_f(t,!1)},100);this.qa(a);a.start()}r(y_f,MV);
function z_f(a){var b=nG(a.Qa);a.Oa.listen(a.Sa,"selectionChange",a.WYb).listen(a.D,"pa",a.VYb).listen(a.D,"za",a.YYb).listen(b,"Rb",a.NRa).listen(a.C,"$d",a.Lrb).listen(a.C,"Zd",a.Krb).listen(a.C,"Yd",a.Irb).listen(a.C,"fe",a.YHb).listen(a.C,"be",a.htb).listen(a.C,"je",a.pLb).listen(a.C,"ge",a.JJb).listen(a.C,"ae",a.msb).listen(a.C,"ke",a.ZYb).listen(a.H.C,"recommender-confidence-update",a.Lub).listen(a.C,"he",a.XYb);wt(wt(wt(wt(wt(wt(vt(a.O,zub,(pt(),qt),function(){a.C.Fia(!zub.isEnabled())}),Bub,
function(){var c=a.C.isVisible();a.hg().setVisible(!c);c||a.C.focus();C_f(a,!c)}),Aub,function(c){oYf(a.C,c.data)}),Wtb,function(){return D_f(a)}),dxb,function(c){return E_f(a,c.data)}),dDb,function(){LYf(a.C,!0)}),QD,function(){return a.sM()})}m=y_f.prototype;m.hg=function(){return Cub};m.hq=function(){return Dub};m.Oy=function(a){MV.prototype.Oy.call(this,a);Aub.Pa(a);B_f(this,!1);!this.Ba&&a&&(this.Ba=!0);var b={};ZA(this.Ra,(b.Ne=a,b));a||this.C.Qc()};
m.H7=function(a){var b=this;this.C.ZBa();var c=new Rq(function(){MV.prototype.H7.call(b,a)},300);this.qa(c);c.start()};m.sM=function(){MV.prototype.sM.call(this);C_f(this,!1)};m.QXa=function(a){this.C.RXa(a);this.H.C.Na=a};m.Lrb=function(a){var b=a.C.H,c=C(C(b,13),3);b=yV(b);var d=new Jh;Tle(d,c);var e=new yr;D(e,1,d);D(e,3,!0);JXe(e,!0);this.L.C(new Jdf(e,b));k_(this,a.zk(),!1,Qcf(Hh(c)))};function C_f(a,b){b?(k_(a,2253),a.va=Oa()):k_(a,2226,!0)}function D_f(a){a.C.isVisible()||a.Oy(!0)}
function E_f(a,b){var c="",d=void 0;b&&b.evt&&(c=b.evt?b.evt.C:"",d=b.evt);var e=JYf(a.C);e&&(e.Gb()?yXf(e,c,!0,!!c,d):(D_f(a),b=new Rq(function(){xXf(e,c,!0,!!c,d)},1E3),a.qa(b),b.start()))}m.YYb=function(){kV(this.H.C)||(this.H.C.reset(),B_f(this,!1))};m.WYb=function(){if(mM(this.Ea)&&null==this.C.O){var a=kV(this.H.C);a&&cI(this.D)!=a.gb()||B_f(this,!0)}};
function B_f(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(d.Na.refresh(void 0),qYf(d));a.H.update(!b,a.C.isVisible(),c)}
m.Lub=function(a){var b=a.C,c=b?b.D:null;a=b?b.C:0;var d=!!b&&.9<=b.C,e=b?b.D.rect:null;e=!!e&&e.Qi()>=Crb&&Fn(e,"r")>=Erb&&Fn(e,"c")>=Frb&&e.Qi()<=Drb;b=!!b&&.6<=b.C&&e;if(b!==this.Na||c&&!c.intersects(this.F))this.Na=b,this.F=c,this.va=Oa(),yub.qb({Nga:b,hD:c});e&&c&&c.rect&&(b=1E3>=c.rect.Qi(),c=ritz_api.RitzModelApi.isFormsRegion(c.C,c.rect.top,c.rect.left,c.rect.height+c.rect.top,c.rect.width+c.rect.left),d=!this.C.isVisible()&&!this.Ba&&d&&b&&!GK(this.Ea.H),c=z(y(),"feeaof")&&c,b=z(y(),"feeaoro")&&
this.Ea.Rd(),d&&(c||b)&&(d=new ok,L(d,1,a),L(d,2,c),L(d,3,b),L(d,5,Hrb),L(d,6,A_f()),a=new lk,sk(a,d),a=fz(cz(bz(new az,10),a)),this.NHa(a)))};m.NHa=function(a){var b=this;if(gI(this.D)&&!ZI(jI(this.D))&&(this.C.Pb=!0,!oC.cea().C)){var c=a||this.ma;this.hg().setVisible(!0);this.V.C(2225,c);k_(this,2253);a=new Rq(function(){b.C.isVisible()||b.V.C(2752,c)},5E3);this.qa(a);a.start()}};
function A_f(){switch(Grb){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}m.msb=function(){this.C.Qc()};m.ZYb=function(a){var b=a.C,c=yV(b.H);this.J=so(c);Toe(this.L.D);JXf(b,c);k_(this,a.zk())};m.VYb=function(){gI(this.D)?(this.C.Pa(!0),this.H.C.reset(),B_f(this,!1)):(this.hg().setVisible(!1),this.H.C.reset(),this.C.Pa(!1))};m.NRa=function(a){B_f(this,!1,bSb(a))};
m.Krb=function(a){var b=jI(this.D),c=b.Kb(),d=[],e=ndf(b);if(e){b=new Xr;var f=bh(e,2);D(b,3,f);f=bh(e,2);D(b,2,f);e=bh(e,1);D(b,1,e);d.push(b)}b=a.C.Sd;for(e=0;e<b.length;e++)f=new Xr,D(f,2,b[e]),d.push(f);this.L.C(new Gdf(d,c));k_(this,a.zk())};
m.Irb=function(a){var b=a.C,c=bdf(b.C),d=yV(b.H),e=c.jz?c.fC:null,f=c.C?c.MB:null,h=d.gb(),k=F_f(d);this.J=so(d);k?(c=new Ndf(k,h,this.J,e,c.Yx,c.ez,f),qJ(c,function(l){l&&a.D.call()}),this.L.C(c)):(c=new Adf(h,this.J,e,c.Yx,c.ez,f),qJ(c,function(l){l&&a.D.call()}),this.L.C(c));d=new wQd;L(d,1,1);c=new JS;vXe(c,C(b.H,2));Yj(c,5,d);b=T5e(this.F,cI(this.D));nV(b,c);b=fz(cz(bz(new az,10),b));this.V.C(a.zk(),b)};
m.YHb=function(a){var b=a.C,c=yV(b.H),d=F_f(c);this.J=so(c);d=new Ddf(d);qJ(d,function(e){e&&a.D.call();JXf(b,c)});this.L.C(d)};m.XYb=function(a){var b=QWe(a.D),c=sWf(b,a.F,a.O),d=this.H,e=a.F;X_e(d.C);d.C.L=b;d.C.Ba=c;d.C.Ea=e;g0e(d.C,!0,!0,!1);k_(this,a.zk());a.D.C!=cI(this.D)&&(c=kI(this.D,a.D.C))&&(c=nG(c),this.Oa.listen(c,"Rb",this.NRa));a.L&&(JYf(this.C)&&JYf(this.C).qT(!0,!1,!0),a=this.C,b=[b],a.isVisible()&&(a.Na.refresh(b),qYf(a)))};
function F_f(a){var b=a.gb();a=so(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.kc(),a.Qb(),a.Sc(),a.Wc(),7,!1);return 0<b.length?b[0]:null}m.htb=function(a){var b=a.Va;$H(jI(this.D),b);k_(this,a.zk())};
m.pLb=function(a){var b=a.C;a=a.zk();if(b instanceof GW||b instanceof Hbf||b instanceof WXf)k_(this,a,void 0,void 0,b.VL());else{var c=pYf(this.C),d=new JS,e=C(b.H,2);c=c.indexOf(b);L(d,1,c);vXe(d,e);e=new lk;nV(e,d);if(b instanceof VWf){(d=b.D)?(b=G_f(this,b,d),b=Fxd(b,d,d.Ql)):b=null;if(!b)return;Yj(e,39,b)}else if(b instanceof oXf){var f=b.H;c=new uQd;if(b instanceof oXf)b=1;else throw Error("Unknown text analysis card type.");f=ah(zV(f),20).slice(0,10);L(c,2,f||[]);L(c,1,b);Yj(d,3,c)}e=fz(cz(bz(new az,
10),e));this.V.C(a,e)}};m.JJb=function(){this.C.Qc()};function G_f(a,b,c){a=pYf(a.C).filter(function(f){return f instanceof VWf});var d=a.map(function(f){return f.Fe()}),e=a[0]&&a[0].J.getSource();return Dxd(c,a.indexOf(b),b.D&&b.D.Te(),d,e)}
function k_(a,b,c,d,e){e=void 0===e?10:e;if(a.F){var f=N(N(Hk(a.ma),ok,58),hta,7);if(c||!f||f.gb()!=a.F.C||f.Qb()!=a.F.rect.Qb()||f.kc()!=a.F.rect.kc()||f.Wc()!=a.F.rect.Wc()||f.Sc()!=a.F.rect.Sc()){f=new ok;L(f,6,A_f());var h=S5e(a.F);Yj(f,7,h);c&&(c=Oa()-a.va,L(f,8,1E3*c),null!=a.C.Bb&&(c=Oa()-a.C.Bb,L(f,10,1E3*c)));d&&xXe(f,d);d=new lk;sk(d,f);a.ma=fz(bz(cz(new az,d),e))}}a.V.C(b,a.ma)}function H_f(){gJ.apply(this,arguments)}r(H_f,gJ);m=H_f.prototype;m.pob=function(){return $Xf};m.Pmb=function(){return HYf};
m.Pnb=function(){return o_f};m.Gnb=function(){return CWf};m.Omb=function(){return y_f};m.Imb=function(){return vWf};m.Inb=function(){return pWf};kJ("assistant",H_f);
